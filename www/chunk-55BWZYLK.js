import{a as ge}from"./chunk-GVLJ6NED.js";import{a as ce,c as he}from"./chunk-5TEEYVJG.js";import{F as te,H as ee,I as ne,K as oe,L as ie,M as se,N as ae,O as re,S as le,a as W6,b as Z6,d as $6,f as c0,g as G1,h as M2,j as z2,k as J6,y as Q6}from"./chunk-4EMNAG2G.js";import"./chunk-OBALZOH7.js";import"./chunk-RT45AM55.js";import"./chunk-2VY4WAJS.js";import"./chunk-ZBIUXTPS.js";import"./chunk-BXPB4ZAG.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-PIQNUW7X.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as L1}from"./chunk-JHI3MBHO.js";var it,To=function(){if(typeof window>"u")return new Map;if(!it){var n=window;n.Ionicons=n.Ionicons||{},it=n.Ionicons.map=n.Ionicons.map||new Map}return it},st=function(n){Object.keys(n).forEach(function(t){de(t,n[t]);var e=t.replace(/([a-z0-9]|(?=[A-Z]))([A-Z0-9])/g,"$1-$2").toLowerCase();t!==e&&de(e,n[t])})},de=function(n,t){var e=To(),o=e.get(n);o===void 0?e.set(n,t):o!==t&&console.warn('[Ionicons Warning]: Multiple icons were mapped to name "'.concat(n,'". Ensure that multiple icons are not mapped to the same icon name.'))};var ve="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M440.08 341.31c-1.66-2-3.29-4-4.89-5.93-22-26.61-35.31-42.67-35.31-118 0-39-9.33-71-27.72-95-13.56-17.73-31.89-31.18-56.05-41.12a3 3 0 01-.82-.67C306.6 51.49 282.82 32 256 32s-50.59 19.49-59.28 48.56a3.13 3.13 0 01-.81.65c-56.38 23.21-83.78 67.74-83.78 136.14 0 75.36-13.29 91.42-35.31 118-1.6 1.93-3.23 3.89-4.89 5.93a35.16 35.16 0 00-4.65 37.62c6.17 13 19.32 21.07 34.33 21.07H410.5c14.94 0 28-8.06 34.19-21a35.17 35.17 0 00-4.61-37.66zM256 480a80.06 80.06 0 0070.44-42.13 4 4 0 00-3.54-5.87H189.12a4 4 0 00-3.55 5.87A80.06 80.06 0 00256 480z'/></svg>";var we=(()=>{let t=class t{constructor(){}getDatos(){return L1(this,null,function*(){let o={url:ge.url+"/calles",method:"GET"};return(yield he.get(o)).data.data})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=W6({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();function Io(n){n.CapacitorUtils.Synapse=new Proxy({},{get(t,e){return new Proxy({},{get(o,i){return(s,a,r)=>{let l=n.Capacitor.Plugins[e];if(l===void 0){r(new Error(`Capacitor plugin ${e} not found`));return}if(typeof l[i]!="function"){r(new Error(`Method ${i} not found in Capacitor plugin ${e}`));return}L1(null,null,function*(){try{let c=yield l[i](s);a(c)}catch(c){r(c)}})}}})}})}function jo(n){n.CapacitorUtils.Synapse=new Proxy({},{get(t,e){return n.cordova.plugins[e]}})}function ue(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?Io(window):window.cordova!==void 0&&jo(window))}var pe=ce("Geolocation",{web:()=>import("./chunk-F2NFXR5V.js").then(n=>new n.GeolocationWeb)});ue();var h1={ADD:"add",REMOVE:"remove"};var X1={PROPERTYCHANGE:"propertychange"};var _={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};var at=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},h0=at;function L0(n,t){return n>t?1:n<t?-1:0}function D0(n,t,e){if(n[0]<=t)return 0;let o=n.length;if(t<=n[o-1])return o-1;if(typeof e=="function"){for(let i=1;i<o;++i){let s=n[i];if(s===t)return i;if(s<t)return e(t,n[i-1],s)>0?i-1:i}return o-1}if(e>0){for(let i=1;i<o;++i)if(n[i]<t)return i-1;return o-1}if(e<0){for(let i=1;i<o;++i)if(n[i]<=t)return i;return o-1}for(let i=1;i<o;++i){if(n[i]==t)return i;if(n[i]<t)return n[i-1]-t<t-n[i]?i-1:i}return o-1}function me(n,t){let e=Array.isArray(t)?t:[t],o=e.length;for(let i=0;i<o;i++)n[n.length]=e[i]}function g0(n,t){let e=n.length;if(e!==t.length)return!1;for(let o=0;o<e;o++)if(n[o]!==t[o])return!1;return!0}function xe(n,t,e){let o=t||L0;return n.every(function(i,s){if(s===0)return!0;let a=o(n[s-1],i);return!(a>0||e&&a===0)})}function A0(){return!0}function K1(){return!1}function B0(){}function fe(n){let t,e,o;return function(){let i=Array.prototype.slice.call(arguments);return(!e||this!==o||!g0(i,e))&&(o=this,e=i,t=n.apply(this,arguments)),t}}function Me(n){function t(){let e;try{e=n()}catch(o){return Promise.reject(o)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function d0(n){for(let t in n)delete n[t]}function n4(n){let t;for(t in n)return!1;return!t}var rt=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var a1=rt;var lt=class extends h0{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;let o=this.listeners_||(this.listeners_={}),i=o[t]||(o[t]=[]);i.includes(e)||i.push(e)}dispatchEvent(t){let e=typeof t=="string",o=e?t:t.type,i=this.listeners_&&this.listeners_[o];if(!i)return;let s=e?new a1(t):t;s.target||(s.target=this.eventTarget_||this);let a=this.dispatching_||(this.dispatching_={}),r=this.pendingRemovals_||(this.pendingRemovals_={});o in a||(a[o]=0,r[o]=0),++a[o];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[o]===0){let c=r[o];for(delete r[o];c--;)this.removeEventListener(o,B0);delete a[o]}return l}disposeInternal(){this.listeners_&&d0(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;let o=this.listeners_[t];if(!o)return;let i=o.indexOf(e);i!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(o[i]=B0,++this.pendingRemovals_[t]):(o.splice(i,1),o.length===0&&delete this.listeners_[t]))}},v0=lt;function R(n,t,e,o,i){if(i){let a=e;e=function(r){return n.removeEventListener(t,e),a.call(o??this,r)}}else o&&o!==n&&(e=e.bind(o));let s={target:n,type:t,listener:e};return n.addEventListener(t,e),s}function F0(n,t,e,o){return R(n,t,e,o,!0)}function F(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),d0(n))}var N0=class extends v0{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(_.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){let o=t.length,i=new Array(o);for(let s=0;s<o;++s)i[s]=R(this,t[s],e);return i}return R(this,t,e)}onceInternal(t,e){let o;if(Array.isArray(t)){let i=t.length;o=new Array(i);for(let s=0;s<i;++s)o[s]=F0(this,t[s],e)}else o=F0(this,t,e);return e.ol_key=o,o}unInternal(t,e){let o=e.ol_key;if(o)Po(o);else if(Array.isArray(t))for(let i=0,s=t.length;i<s;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}};N0.prototype.on;N0.prototype.once;N0.prototype.un;function Po(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)F(n[t]);else F(n)}var o4=N0;function O(){throw new Error("Unimplemented abstract method.")}var Do=0;function q(n){return n.ol_uid||(n.ol_uid=String(++Do))}var i4=class extends a1{constructor(t,e,o){super(t),this.key=e,this.oldValue=o}},ct=class extends o4{constructor(t){super(),this.on,this.once,this.un,q(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let o;o=`change:${t}`,this.hasListener(o)&&this.dispatchEvent(new i4(o,t,e)),o=X1.PROPERTYCHANGE,this.hasListener(o)&&this.dispatchEvent(new i4(o,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,o){let i=this.values_||(this.values_={});if(o)i[t]=e;else{let s=i[t];i[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(let o in t)this.set(o,t[o],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){let o=this.values_[t];delete this.values_[t],n4(this.values_)&&(this.values_=null),e||this.notify(t,o)}}},Q=ct;var ze={LENGTH:"length"},q0=class extends a1{constructor(t,e,o){super(t),this.element=e,this.index=o}},ht=class extends Q{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let o=0,i=this.array_.length;o<i;++o)this.assertUnique_(this.array_[o],o);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,o=t.length;e<o;++e)this.push(t[e]);return this}forEach(t){let e=this.array_;for(let o=0,i=e.length;o<i;++o)t(e[o],o,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(ze.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new q0(h1.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);let e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){let e=this.array_;for(let o=0,i=e.length;o<i;++o)if(e[o]===t)return this.removeAt(o)}removeAt(t){if(t<0||t>=this.getLength())return;let e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new q0(h1.REMOVE,e,t)),e}setAt(t,e){let o=this.getLength();if(t>=o){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);let i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new q0(h1.REMOVE,i,t)),this.dispatchEvent(new q0(h1.ADD,e,t))}updateLength_(){this.set(ze.LENGTH,this.array_.length)}assertUnique_(t,e){for(let o=0,i=this.array_.length;o<i;++o)if(this.array_[o]===t&&o!==e)throw new Error("Duplicate item added to a unique collection")}},m1=ht;var gt=class extends a1{constructor(t,e,o){super(t),this.map=e,this.frameState=o!==void 0?o:null}},w0=gt;var dt=class extends w0{constructor(t,e,o,i,s,a){super(t,e,s),this.originalEvent=o,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},b1=dt;var U={SINGLECLICK:"singleclick",CLICK:_.CLICK,DBLCLICK:_.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var S0=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Fo=S0.includes("safari")&&!S0.includes("chrom"),Ns=Fo&&(S0.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(S0)),ke=S0.includes("webkit")&&!S0.includes("edge"),vt=S0.includes("macintosh"),ye=typeof devicePixelRatio<"u"?devicePixelRatio:1,_e=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,wt=typeof Image<"u"&&Image.prototype.decode;var s4=(function(){let n=!1;try{let t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n})();var k2={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var ut=class extends v0{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;let o=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=o,this.pointerdownListenerKey_=R(o,k2.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=R(o,k2.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(_.TOUCHMOVE,this.boundHandleTouchMove_,s4?{passive:!1}:!1)}emulateClick_(t){let e=new b1(U.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new b1(U.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let o=new b1(U.SINGLECLICK,this.map_,t);this.dispatchEvent(o)},250)}updateActivePointers_(t){let e=t,o=e.pointerId;if(e.type==U.POINTERUP||e.type==U.POINTERCANCEL){delete this.trackedTouches_[o];for(let i in this.trackedTouches_)if(this.trackedTouches_[i].target!==e.target){delete this.trackedTouches_[i];break}}else(e.type==U.POINTERDOWN||e.type==U.POINTERMOVE)&&(this.trackedTouches_[o]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);let e=new b1(U.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(F),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);let e=new b1(U.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){let o=this.map_.getOwnerDocument();this.dragListenerKeys_.push(R(o,U.POINTERMOVE,this.handlePointerMove_,this),R(o,U.POINTERUP,this.handlePointerUp_,this),R(this.element_,U.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==o&&this.dragListenerKeys_.push(R(this.element_.getRootNode(),U.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;let e=new b1(U.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;let e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new b1(U.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){let e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(F(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(_.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(F(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(F),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Ce=ut;var I1={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"};var o1={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var y={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function T(n,t){if(!n)throw new Error(t)}var y2=1/0,pt=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,d0(this.queuedElements_)}dequeue(){let t=this.elements_,e=this.priorities_,o=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));let i=this.keyFunction_(o);return delete this.queuedElements_[i],o}enqueue(t){T(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let e=this.priorityFunction_(t);return e!=y2?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){let e=this.elements_,o=this.priorities_,i=e.length,s=e[t],a=o[t],r=t;for(;t<i>>1;){let l=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),h=c<i&&o[c]<o[l]?c:l;e[t]=e[h],o[t]=o[h],t=h}e[t]=s,o[t]=a,this.siftDown_(r,t)}siftDown_(t,e){let o=this.elements_,i=this.priorities_,s=o[e],a=i[e];for(;e>t;){let r=this.getParentIndex_(e);if(i[r]>a)o[e]=o[r],i[e]=i[r],e=r;else break}o[e]=s,i[e]=a}reprioritize(){let t=this.priorityFunction_,e=this.elements_,o=this.priorities_,i=0,s=e.length,a,r,l;for(r=0;r<s;++r)a=e[r],l=t(a),l==y2?delete this.queuedElements_[this.keyFunction_(a)]:(o[i]=l,e[i++]=a);e.length=i,o.length=i,this.heapify_()}},Le=pt;var mt=class extends Le{constructor(t,e){super(o=>t.apply(null,o),o=>o[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){let e=super.enqueue(t);return e&&t[0].addEventListener(_.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){let e=t.target,o=e.getState();if(o===y.LOADED||o===y.ERROR||o===y.EMPTY){o!==y.ERROR&&e.removeEventListener(_.CHANGE,this.boundHandleTileChange_);let i=e.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let o=0;for(;this.tilesLoading_<t&&o<e&&this.getCount()>0;){let i=this.dequeue()[0],s=i.getKey();i.getState()===y.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++o,i.load())}}},Ae=mt;function Be(n,t,e,o,i){if(!n||!(e in n.wantedTiles))return y2;if(!n.wantedTiles[e][t.getKey()])return y2;let s=n.viewState.center,a=o[0]-s[0],r=o[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+r*r)/i}var v1={ANIMATING:0,INTERACTING:1};var z1={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function N(n,t,e){return Math.min(Math.max(n,t),e)}function Se(n,t,e,o,i,s){let a=i-e,r=s-o;if(a!==0||r!==0){let l=((n-e)*a+(t-o)*r)/(a*a+r*r);l>1?(e=i,o=s):l>0&&(e+=a*l,o+=r*l)}return Y1(n,t,e,o)}function Y1(n,t,e,o){let i=e-n,s=o-t;return i*i+s*s}function Ee(n){let t=n.length;for(let o=0;o<t;o++){let i=o,s=Math.abs(n[o][o]);for(let r=o+1;r<t;r++){let l=Math.abs(n[r][o]);l>s&&(s=l,i=r)}if(s===0)return null;let a=n[i];n[i]=n[o],n[o]=a;for(let r=o+1;r<t;r++){let l=-n[r][o]/n[o][o];for(let c=o;c<t+1;c++)o==c?n[r][c]=0:n[r][c]+=l*n[o][c]}}let e=new Array(t);for(let o=t-1;o>=0;o--){e[o]=n[o][t]/n[o][o];for(let i=o-1;i>=0;i--)n[i][t]-=n[i][o]*e[o]}return e}function a4(n){return n*180/Math.PI}function A1(n){return n*Math.PI/180}function W1(n,t){let e=n%t;return e*t<0?e+t:e}function Ve(n,t,e){return n+e*(t-n)}function r4(n,t){let e=Math.pow(10,t);return Math.round(n*e)/e}function _2(n,t){return Math.floor(r4(n,t))}function C2(n,t){return Math.ceil(r4(n,t))}function l4(n,t,e){if(n>=t&&n<e)return n;let o=e-t;return((n-t)%o+o)%o+t}function xt(n,t,e){return(function(o,i,s,a,r){if(!o)return;if(!i&&!t)return o;let l=t?0:s[0]*i,c=t?0:s[1]*i,h=r?r[0]:0,g=r?r[1]:0,d=n[0]+l/2+h,w=n[2]-l/2+h,v=n[1]+c/2+g,m=n[3]-c/2+g;d>w&&(d=(w+d)/2,w=d),v>m&&(v=(m+v)/2,m=v);let p=N(o[0],d,w),x=N(o[1],v,m);if(a&&e&&i){let M=30*i;p+=-M*Math.log(1+Math.max(0,d-o[0])/M)+M*Math.log(1+Math.max(0,o[0]-w)/M),x+=-M*Math.log(1+Math.max(0,v-o[1])/M)+M*Math.log(1+Math.max(0,o[1]-m)/M)}return[p,x]})}function He(n){return n}var t1={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ft(n){let t=k1();for(let e=0,o=n.length;e<o;++e)A2(t,n[e]);return t}function No(n,t,e){let o=Math.min.apply(null,n),i=Math.min.apply(null,t),s=Math.max.apply(null,n),a=Math.max.apply(null,t);return u0(o,i,s,a,e)}function Re(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function c4(n,t,e){let o,i;return t<n[0]?o=n[0]-t:n[2]<t?o=t-n[2]:o=0,e<n[1]?i=n[1]-e:n[3]<e?i=e-n[3]:i=0,o*o+i*i}function U0(n,t){return Mt(n,t[0],t[1])}function Mt(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Oe(n,t){let e=n[0],o=n[1],i=n[2],s=n[3],a=t[0],r=t[1],l=t1.UNKNOWN;return a<e?l=l|t1.LEFT:a>i&&(l=l|t1.RIGHT),r<o?l=l|t1.BELOW:r>s&&(l=l|t1.ABOVE),l===t1.UNKNOWN&&(l=t1.INTERSECTING),l}function k1(){return[1/0,1/0,-1/0,-1/0]}function u0(n,t,e,o,i){return i?(i[0]=n,i[1]=t,i[2]=e,i[3]=o,i):[n,t,e,o]}function E0(n){return u0(1/0,1/0,-1/0,-1/0,n)}function Te(n,t){let e=n[0],o=n[1];return u0(e,o,e,o,t)}function be(n,t,e,o,i){let s=E0(i);return zt(s,n,t,e,o)}function L2(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function Ie(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function A2(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function zt(n,t,e,o,i){for(;e<o;e+=i)qo(n,t[e],t[e+1]);return n}function qo(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function h4(n,t){let e;return e=t(G0(n)),e||(e=t(X0(n)),e)||(e=t(K0(n)),e)||(e=t(y1(n)),e)?e:!1}function B2(n){let t=0;return p0(n)||(t=I(n)*J(n)),t}function G0(n){return[n[0],n[1]]}function X0(n){return[n[2],n[1]]}function j1(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function je(n,t){let e;if(t==="bottom-left")e=G0(n);else if(t==="bottom-right")e=X0(n);else if(t==="top-left")e=y1(n);else if(t==="top-right")e=K0(n);else throw new Error("Invalid corner");return e}function S2(n,t,e,o,i){let[s,a,r,l,c,h,g,d]=kt(n,t,e,o);return u0(Math.min(s,r,c,g),Math.min(a,l,h,d),Math.max(s,r,c,g),Math.max(a,l,h,d),i)}function kt(n,t,e,o){let i=t*o[0]/2,s=t*o[1]/2,a=Math.cos(e),r=Math.sin(e),l=i*a,c=i*r,h=s*a,g=s*r,d=n[0],w=n[1];return[d-l+g,w-c-h,d-l-g,w-c+h,d+l-g,w+c+h,d+l+g,w+c-h,d-l+g,w-c-h]}function J(n){return n[3]-n[1]}function P1(n,t,e){let o=e||k1();return Z1(n,t)?(n[0]>t[0]?o[0]=n[0]:o[0]=t[0],n[1]>t[1]?o[1]=n[1]:o[1]=t[1],n[2]<t[2]?o[2]=n[2]:o[2]=t[2],n[3]<t[3]?o[3]=n[3]:o[3]=t[3]):E0(o),o}function y1(n){return[n[0],n[3]]}function K0(n){return[n[2],n[3]]}function I(n){return n[2]-n[0]}function Z1(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function p0(n){return n[2]<n[0]||n[3]<n[1]}function Pe(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function De(n,t,e){let o=!1,i=Oe(n,t),s=Oe(n,e);if(i===t1.INTERSECTING||s===t1.INTERSECTING)o=!0;else{let a=n[0],r=n[1],l=n[2],c=n[3],h=t[0],g=t[1],d=e[0],w=e[1],v=(w-g)/(d-h),m,p;s&t1.ABOVE&&!(i&t1.ABOVE)&&(m=d-(w-c)/v,o=m>=a&&m<=l),!o&&s&t1.RIGHT&&!(i&t1.RIGHT)&&(p=w-(d-l)*v,o=p>=r&&p<=c),!o&&s&t1.BELOW&&!(i&t1.BELOW)&&(m=d-(w-r)/v,o=m>=a&&m<=l),!o&&s&t1.LEFT&&!(i&t1.LEFT)&&(p=w-(d-a)*v,o=p>=r&&p<=c)}return o}function Fe(n,t,e,o){if(p0(n))return E0(e);let i=[];if(o>1){let r=n[2]-n[0],l=n[3]-n[1];for(let c=0;c<o;++c)i.push(n[0]+r*c/o,n[1],n[2],n[1]+l*c/o,n[2]-r*c/o,n[3],n[0],n[3]-l*c/o)}else i=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];t(i,i,2);let s=[],a=[];for(let r=0,l=i.length;r<l;r+=2)s.push(i[r]),a.push(i[r+1]);return No(s,a,e)}function Uo(n,t){let e=t.getExtent(),o=j1(n);if(t.canWrapX()&&(o[0]<e[0]||o[0]>=e[2])){let i=I(e),a=Math.floor((o[0]-e[0])/i)*i;n[0]-=a,n[2]-=a}return n}function Ne(n,t,e){if(t.canWrapX()){let o=t.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[o[0],n[1],o[2],n[3]]];Uo(n,t);let i=I(o);if(I(n)>i&&!e)return[[o[0],n[1],o[2],n[3]]];if(n[0]<o[0])return[[n[0]+i,n[1],o[2],n[3]],[o[0],n[1],n[2],n[3]]];if(n[2]>o[2])return[[n[0],n[1],o[2],n[3]],[o[0],n[1],n[2]-i,n[3]]]}return[n]}function qe(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function V0(n,t){let e=!0;for(let o=n.length-1;o>=0;--o)if(n[o]!=t[o]){e=!1;break}return e}function Y0(n,t){let e=Math.cos(t),o=Math.sin(t),i=n[0]*e-n[1]*o,s=n[1]*e+n[0]*o;return n[0]=i,n[1]=s,n}function Ue(n,t){return n[0]*=t,n[1]*=t,n}function Ge(n,t){if(t.canWrapX()){let e=I(t.getExtent()),o=Xe(n,t,e);o&&(n[0]-=o*e)}return n}function Xe(n,t,e){let o=t.getExtent(),i=0;return t.canWrapX()&&(n[0]<o[0]||n[0]>o[2])&&(e=e||I(o),i=Math.floor((n[0]-o[0])/e)),i}function yt(n){return Math.pow(n,3)}function _1(n){return 1-yt(1-n)}function Ke(n){return 3*n*n-2*n*n*n}function Ye(n){return n}var Go=63710088e-1;function _t(n,t,e){e=e||Go;let o=A1(n[1]),i=A1(t[1]),s=(i-o)/2,a=A1(t[0]-n[0])/2,r=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(o)*Math.cos(i);return 2*e*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))}var We={info:1,warn:2,error:3,none:4},Xo=We.info;function g4(...n){Xo>We.warn||console.warn(...n)}var $1={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var Ct=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||$1[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},W0=Ct;var E2=6378137,Z0=Math.PI*E2,Ko=[-Z0,-Z0,Z0,Z0],Yo=[-180,-85,180,85],d4=E2*Math.log(Math.tan(Math.PI/2)),m0=class extends W0{constructor(t){super({code:t,units:"m",extent:Ko,global:!0,worldExtent:Yo,getPointResolution:function(e,o){return e/Math.cosh(o[1]/E2)}})}},Lt=[new m0("EPSG:3857"),new m0("EPSG:102100"),new m0("EPSG:102113"),new m0("EPSG:900913"),new m0("http://www.opengis.net/def/crs/EPSG/0/3857"),new m0("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Ze(n,t,e,o){let i=n.length;e=e>1?e:2,o=o??e,t===void 0&&(e>2?t=n.slice():t=new Array(i));for(let s=0;s<i;s+=o){t[s]=Z0*n[s]/180;let a=E2*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>d4?a=d4:a<-d4&&(a=-d4),t[s+1]=a}return t}function $e(n,t,e,o){let i=n.length;e=e>1?e:2,o=o??e,t===void 0&&(e>2?t=n.slice():t=new Array(i));for(let s=0;s<i;s+=o)t[s]=180*n[s]/Z0,t[s+1]=360*Math.atan(Math.exp(n[s+1]/E2))/Math.PI-90;return t}var Wo=6378137,Je=[-180,-90,180,90],Zo=Math.PI*Wo/180,J1=class extends W0{constructor(t,e){super({code:t,units:"degrees",extent:Je,axisOrientation:e,global:!0,metersPerUnit:Zo,worldExtent:Je})}},At=[new J1("CRS:84"),new J1("EPSG:4326","neu"),new J1("urn:ogc:def:crs:OGC:1.3:CRS84"),new J1("urn:ogc:def:crs:OGC:2:84"),new J1("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new J1("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new J1("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var Bt={};function Qe(n){return Bt[n]||Bt[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function t8(n,t){Bt[n]=t}var $0={};function J0(n,t,e){let o=n.getCode(),i=t.getCode();o in $0||($0[o]={}),$0[o][i]=e}function v4(n,t){return n in $0&&t in $0[n]?$0[n][t]:null}var w4=.9996,C1=.00669438,p4=C1*C1,m4=p4*C1,H0=C1/(1-C1),e8=Math.sqrt(1-C1),Q0=(1-e8)/(1+e8),s8=Q0*Q0,St=s8*Q0,Et=St*Q0,a8=Et*Q0,r8=1-C1/4-3*p4/64-5*m4/256,$o=3*C1/8+3*p4/32+45*m4/1024,Jo=15*p4/256+45*m4/1024,Qo=35*m4/3072,ti=3/2*Q0-27/32*St+269/512*a8,ei=21/16*s8-55/32*Et,ni=151/96*St-417/128*a8,oi=1097/512*Et,u4=6378137;function ii(n,t,e){let o=n-5e5,a=(e.north?t:t-1e7)/w4/(u4*r8),r=a+ti*Math.sin(2*a)+ei*Math.sin(4*a)+ni*Math.sin(6*a)+oi*Math.sin(8*a),l=Math.sin(r),c=l*l,h=Math.cos(r),g=l/h,d=g*g,w=d*d,v=1-C1*c,m=Math.sqrt(1-C1*c),p=u4/m,x=(1-C1)/v,M=H0*h**2,k=M*M,z=o/(p*w4),f=z*z,A=f*z,B=A*z,C=B*z,S=C*z,E=r-g/x*(f/2-B/24*(5+3*d+10*M-4*k-9*H0))+S/720*(61+90*d+298*M+45*w-252*H0-3*k),Z=(z-A/6*(1+2*d+M)+C/120*(5-2*M+28*d-3*k+8*H0+24*w))/h;return Z=l4(Z+A1(l8(e.number)),-Math.PI,Math.PI),[a4(Z),a4(E)]}var n8=-80,o8=84,si=-180,ai=180;function ri(n,t,e){n=l4(n,si,ai),t<n8?t=n8:t>o8&&(t=o8);let o=A1(t),i=Math.sin(o),s=Math.cos(o),a=i/s,r=a*a,l=r*r,c=A1(n),h=l8(e.number),g=A1(h),d=u4/Math.sqrt(1-C1*i**2),w=H0*s**2,v=s*l4(c-g,-Math.PI,Math.PI),m=v*v,p=m*v,x=p*v,M=x*v,k=M*v,z=u4*(r8*o-$o*Math.sin(2*o)+Jo*Math.sin(4*o)-Qo*Math.sin(6*o)),f=w4*d*(v+p/6*(1-r+w)+M/120*(5-18*r+l+72*w-58*H0))+5e5,A=w4*(z+d*a*(m/2+x/24*(5-r+9*w+4*w**2)+k/720*(61-58*r+l+600*w-330*H0)));return e.north||(A+=1e7),[f,A]}function l8(n){return(n-1)*6-180+3}var li=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function c8(n){let t=0;for(let i of li){let s=n.match(i);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,o=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(o=!0,e=t-32600),e?{number:e,north:o}:null}function i8(n,t){return function(e,o,i,s){let a=e.length;i=i>1?i:2,s=s??i,o||(i>2?o=e.slice():o=new Array(a));for(let r=0;r<a;r+=s){let l=e[r],c=e[r+1],h=n(l,c,t);o[r]=h[0],o[r+1]=h[1]}return o}}function h8(n){return c8(n)?new W0({code:n,units:"m"}):null}function g8(n){let t=c8(n.getCode());return t?{forward:i8(ri,t),inverse:i8(ii,t)}:null}var ci=[g8],hi=[h8];var Ht=!0;function Rt(n){Ht=!(n===void 0?!0:n)}function Tt(n,t){if(t!==void 0){for(let e=0,o=n.length;e<o;++e)t[e]=n[e];t=t}else t=n.slice();return t}function Ot(n){t8(n.getCode(),n),J0(n,n,Tt)}function gi(n){n.forEach(Ot)}function i1(n){if(typeof n!="string")return n;let t=Qe(n);if(t)return t;for(let e of hi){let o=e(n);if(o)return o}return null}function bt(n,t,e,o){n=i1(n);let i,s=n.getPointResolutionFunc();if(s){if(i=s(t,e),o&&o!==n.getUnits()){let a=n.getMetersPerUnit();a&&(i=i*a/$1[o])}}else{let a=n.getUnits();if(a=="degrees"&&!o||o=="degrees")i=t;else{let r=jt(n,i1("EPSG:4326"));if(!r&&a!=="degrees")i=t*n.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=r(c,c,2);let h=_t(c.slice(0,2),c.slice(2,4)),g=_t(c.slice(4,6),c.slice(6,8));i=(h+g)/2}let l=o?$1[o]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function d8(n){gi(n),n.forEach(function(t){n.forEach(function(e){t!==e&&J0(t,e,Tt)})})}function di(n,t,e,o){n.forEach(function(i){t.forEach(function(s){J0(i,s,e),J0(s,i,o)})})}function x4(n,t){return n?typeof n=="string"?i1(n):n:i1(t)}function v8(n){return(function(t,e,o,i){let s=t.length;o=o!==void 0?o:2,i=i??o,e=e!==void 0?e:new Array(s);for(let a=0;a<s;a+=i){let r=n(t.slice(a,a+o)),l=r.length;for(let c=0,h=i;c<h;++c)e[a+c]=c>=l?t[a+c]:r[c]}return e})}function It(n,t){return Rt(),R0(n,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function f4(n,t){if(n===t)return!0;let e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||jt(n,t)===Tt)&&e}function jt(n,t){let e=n.getCode(),o=t.getCode(),i=v4(e,o);if(i)return i;let s=null,a=null;for(let l of ci)s||(s=l(n)),a||(a=l(t));if(!s&&!a)return null;let r="EPSG:4326";if(a)if(s)i=Vt(s.inverse,a.forward);else{let l=v4(e,r);l&&(i=Vt(l,a.forward))}else{let l=v4(r,o);l&&(i=Vt(s.inverse,l))}return i&&(Ot(n),Ot(t),J0(n,t,i)),i}function Vt(n,t){return function(e,o,i,s){return o=n(e,o,i,s),t(o,o,i,s)}}function O0(n,t){let e=i1(n),o=i1(t);return jt(e,o)}function R0(n,t,e){let o=O0(t,e);if(!o){let i=i1(t).getCode(),s=i1(e).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return o(n,void 0,n.length)}function w8(n,t,e,o){let i=O0(t,e);return Fe(n,i,void 0,o)}var Q1=null;function u8(){return Q1}function V2(n,t){return Q1?R0(n,t,Q1):n}function B1(n,t){return Q1?R0(n,Q1,t):(Ht&&!V0(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Ht=!1,g4("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n)}function p8(n,t){return Q1?w8(n,t,Q1):n}function t0(n,t){return Q1?w8(n,Q1,t):n}function vi(){d8(Lt),d8(At),di(At,Lt,Ze,$e)}vi();var Za=new Array(6);function e0(){return[1,0,0,1,0,0]}function s1(n,t){let e=t[0],o=t[1];return t[0]=n[0]*e+n[2]*o+n[4],t[1]=n[1]*e+n[3]*o+n[5],t}function n0(n,t,e,o,i,s,a,r){let l=Math.sin(s),c=Math.cos(s);return n[0]=o*c,n[1]=i*l,n[2]=-o*l,n[3]=i*c,n[4]=a*o*c-r*o*l+t,n[5]=a*i*l+r*i*c+e,n}function M4(n,t){let e=wi(t);T(e!==0,"Transformation matrix cannot be inverted");let o=t[0],i=t[1],s=t[2],a=t[3],r=t[4],l=t[5];return n[0]=a/e,n[1]=-i/e,n[2]=-s/e,n[3]=o/e,n[4]=(s*l-a*r)/e,n[5]=-(o*l-i*r)/e,n}function wi(n){return n[0]*n[3]-n[1]*n[2]}var ui=[1e5,1e5,1e5,1e5,2,2];function x8(n){return"matrix("+n.join(", ")+")"}function m8(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function f8(n,t){let e=m8(n),o=m8(t);for(let i=0;i<6;++i)if(Math.round((e[i]-o[i])*ui[i])!==0)return!1;return!0}function Pt(n,t,e,o,i,s,a){s=s||[],a=a||2;let r=0;for(let l=t;l<e;l+=o){let c=n[l],h=n[l+1];s[r++]=i[0]*c+i[2]*h+i[4],s[r++]=i[1]*c+i[3]*h+i[5];for(let g=2;g<a;g++)s[r++]=n[l+g]}return s&&s.length!=r&&(s.length=r),s}function M8(n,t,e,o,i,s,a){a=a||[];let r=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1],g=0;for(let d=t;d<e;d+=o){let w=n[d]-c,v=n[d+1]-h;a[g++]=c+w*r-v*l,a[g++]=h+w*l+v*r;for(let m=d+2;m<d+o;++m)a[g++]=n[m]}return a&&a.length!=g&&(a.length=g),a}function z8(n,t,e,o,i,s,a,r){r=r||[];let l=a[0],c=a[1],h=0;for(let g=t;g<e;g+=o){let d=n[g]-l,w=n[g+1]-c;r[h++]=l+i*d,r[h++]=c+s*w;for(let v=g+2;v<g+o;++v)r[h++]=n[v]}return r&&r.length!=h&&(r.length=h),r}function k8(n,t,e,o,i,s,a){a=a||[];let r=0;for(let l=t;l<e;l+=o){a[r++]=n[l]+i,a[r++]=n[l+1]+s;for(let c=l+2;c<l+o;++c)a[r++]=n[c]}return a&&a.length!=r&&(a.length=r),a}var y8=e0(),pi=[NaN,NaN],Dt=class extends Q{constructor(){super(),this.extent_=k1(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=fe((t,e,o)=>{if(!o)return this.getSimplifiedGeometry(e);let i=this.clone();return i.applyTransform(o),i.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return O()}closestPointXY(t,e,o,i){return O()}containsXY(t,e){return this.closestPointXY(t,e,pi,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return O()}getExtent(t){if(this.extentRevision_!=this.getRevision()){let e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&E0(e),this.extentRevision_=this.getRevision()}return Pe(this.extent_,t)}rotate(t,e){O()}scale(t,e,o){O()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return O()}getType(){return O()}applyTransform(t){O()}intersectsExtent(t){return O()}translate(t,e){O()}transform(t,e){let o=i1(t),i=o.getUnits()=="tile-pixels"?function(s,a,r){let l=o.getExtent(),c=o.getWorldExtent(),h=J(c)/J(l);n0(y8,c[0],c[3],h,-h,0,0,0);let g=Pt(s,0,s.length,r,y8,a),d=O0(o,e);return d?d(g,g,r):g}:O0(o,e);return this.applyTransform(i),this}},_8=Dt;var Ft=class extends _8{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return be(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return O()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;let e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=C8(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){O()}setLayout(t,e,o){let i;if(t)i=C8(t);else{for(let s=0;s<o;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}i=e.length,t=mi(i)}this.layout=t,this.stride=i}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){let o=this.getFlatCoordinates();if(o){let i=this.getStride();M8(o,0,o.length,i,t,e,o),this.changed()}}scale(t,e,o){e===void 0&&(e=t),o||(o=j1(this.getExtent()));let i=this.getFlatCoordinates();if(i){let s=this.getStride();z8(i,0,i.length,s,t,e,o,i),this.changed()}}translate(t,e){let o=this.getFlatCoordinates();if(o){let i=this.getStride();k8(o,0,o.length,i,t,e,o),this.changed()}}};function mi(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function C8(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}var t2=Ft;function Nt(n,t,e,o){let i=0,s=n[e-o],a=n[e-o+1],r=0,l=0;for(;t<e;t+=o){let c=n[t]-s,h=n[t+1]-a;i+=l*c-r*h,r=c,l=h}return i/2}function L8(n,t,e,o){let i=0;for(let s=0,a=e.length;s<a;++s){let r=e[s];i+=Nt(n,t,r,o),t=r}return i}function A8(n,t,e,o,i,s,a){let r=n[t],l=n[t+1],c=n[e]-r,h=n[e+1]-l,g;if(c===0&&h===0)g=t;else{let d=((i-r)*c+(s-l)*h)/(c*c+h*h);if(d>1)g=e;else if(d>0){for(let w=0;w<o;++w)a[w]=Ve(n[t+w],n[e+w],d);a.length=o;return}else g=t}for(let d=0;d<o;++d)a[d]=n[g+d];a.length=o}function qt(n,t,e,o,i){let s=n[t],a=n[t+1];for(t+=o;t<e;t+=o){let r=n[t],l=n[t+1],c=Y1(s,a,r,l);c>i&&(i=c),s=r,a=l}return i}function B8(n,t,e,o,i){for(let s=0,a=e.length;s<a;++s){let r=e[s];i=qt(n,t,r,o,i),t=r}return i}function Ut(n,t,e,o,i,s,a,r,l,c,h){if(t==e)return c;let g,d;if(i===0){if(d=Y1(a,r,n[t],n[t+1]),d<c){for(g=0;g<o;++g)l[g]=n[t+g];return l.length=o,d}return c}h=h||[NaN,NaN];let w=t+o;for(;w<e;)if(A8(n,w-o,w,o,a,r,h),d=Y1(a,r,h[0],h[1]),d<c){for(c=d,g=0;g<o;++g)l[g]=h[g];l.length=o,w+=o}else w+=o*Math.max((Math.sqrt(d)-Math.sqrt(c))/i|0,1);if(s&&(A8(n,e-o,t,o,a,r,h),d=Y1(a,r,h[0],h[1]),d<c)){for(c=d,g=0;g<o;++g)l[g]=h[g];l.length=o}return c}function S8(n,t,e,o,i,s,a,r,l,c,h){h=h||[NaN,NaN];for(let g=0,d=e.length;g<d;++g){let w=e[g];c=Ut(n,t,w,o,i,s,a,r,l,c,h),t=w}return c}function E8(n,t,e,o){for(let i=0,s=e.length;i<s;++i)n[t++]=e[i];return t}function Gt(n,t,e,o){for(let i=0,s=e.length;i<s;++i){let a=e[i];for(let r=0;r<o;++r)n[t++]=a[r]}return t}function V8(n,t,e,o,i){i=i||[];let s=0;for(let a=0,r=e.length;a<r;++a){let l=Gt(n,t,e[a],o);i[s++]=l,t=l}return i.length=s,i}function Xt(n,t,e,o,i){i=i!==void 0?i:[];let s=0;for(let a=t;a<e;a+=o)i[s++]=n.slice(a,a+o);return i.length=s,i}function H8(n,t,e,o,i){i=i!==void 0?i:[];let s=0;for(let a=0,r=e.length;a<r;++a){let l=e[a];i[s++]=Xt(n,t,l,o,i[s]),t=l}return i.length=s,i}function O8(n,t,e,o,i,s,a){let r=(e-t)/o;if(r<3){for(;t<e;t+=o)s[a++]=n[t],s[a++]=n[t+1];return a}let l=new Array(r);l[0]=1,l[r-1]=1;let c=[t,e-o],h=0;for(;c.length>0;){let g=c.pop(),d=c.pop(),w=0,v=n[d],m=n[d+1],p=n[g],x=n[g+1];for(let M=d+o;M<g;M+=o){let k=n[M],z=n[M+1],f=Se(k,z,v,m,p,x);f>w&&(h=M,w=f)}w>i&&(l[(h-t)/o]=1,d+o<h&&c.push(d,h),h+o<g&&c.push(h,g))}for(let g=0;g<r;++g)l[g]&&(s[a++]=n[t+g*o],s[a++]=n[t+g*o+1]);return a}function e2(n,t){return t*Math.round(n/t)}function xi(n,t,e,o,i,s,a){if(t==e)return a;let r=e2(n[t],i),l=e2(n[t+1],i);t+=o,s[a++]=r,s[a++]=l;let c,h;do if(c=e2(n[t],i),h=e2(n[t+1],i),t+=o,t==e)return s[a++]=c,s[a++]=h,a;while(c==r&&h==l);for(;t<e;){let g=e2(n[t],i),d=e2(n[t+1],i);if(t+=o,g==c&&d==h)continue;let w=c-r,v=h-l,m=g-r,p=d-l;if(w*p==v*m&&(w<0&&m<w||w==m||w>0&&m>w)&&(v<0&&p<v||v==p||v>0&&p>v)){c=g,h=d;continue}s[a++]=c,s[a++]=h,r=c,l=h,c=g,h=d}return s[a++]=c,s[a++]=h,a}function R8(n,t,e,o,i,s,a,r){for(let l=0,c=e.length;l<c;++l){let h=e[l];a=xi(n,t,h,o,i,s,a),r.push(a),t=h}return a}var Kt=class n extends t2{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new n(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,o,i){return i<c4(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ut(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,o,i))}getArea(){return Nt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Xt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){let e=[];return e.length=O8(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new n(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Gt(this.flatCoordinates,0,t,this.stride),this.changed()}},Yt=Kt;var Wt=class n extends t2{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){let t=new n(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,o,i){let s=this.flatCoordinates,a=Y1(t,e,s[0],s[1]);if(a<i){let r=this.stride;for(let l=0;l<r;++l)o[l]=s[l];return o.length=r,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Te(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Mt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=E8(this.flatCoordinates,0,t,this.stride),this.changed()}},T8=Wt;function b8(n,t,e,o,i){return!h4(i,function(a){return!x0(n,t,e,o,a[0],a[1])})}function x0(n,t,e,o,i,s){let a=0,r=n[e-o],l=n[e-o+1];for(;t<e;t+=o){let c=n[t],h=n[t+1];l<=s?h>s&&(c-r)*(s-l)-(i-r)*(h-l)>0&&a++:h<=s&&(c-r)*(s-l)-(i-r)*(h-l)<0&&a--,r=c,l=h}return a!==0}function z4(n,t,e,o,i,s){if(e.length===0||!x0(n,t,e[0],o,i,s))return!1;for(let a=1,r=e.length;a<r;++a)if(x0(n,e[a-1],e[a],o,i,s))return!1;return!0}function I8(n,t,e,o,i,s,a){let r,l,c,h,g,d,w,v=i[s+1],m=[];for(let M=0,k=e.length;M<k;++M){let z=e[M];for(h=n[z-o],d=n[z-o+1],r=t;r<z;r+=o)g=n[r],w=n[r+1],(v<=d&&w<=v||d<=v&&v<=w)&&(c=(v-d)/(w-d)*(g-h)+h,m.push(c)),h=g,d=w}let p=NaN,x=-1/0;for(m.sort(L0),h=m[0],r=1,l=m.length;r<l;++r){g=m[r];let M=Math.abs(g-h);M>x&&(c=(h+g)/2,z4(n,t,e,o,c,v)&&(p=c,x=M)),h=g}return isNaN(p)&&(p=i[s]),a?(a.push(p,v,x),a):[p,v,x]}function j8(n,t,e,o,i){let s;for(t+=o;t<e;t+=o)if(s=i(n.slice(t-o,t),n.slice(t,t+o)),s)return s;return!1}function P8(n,t,e,o,i,s){return s=s??zt(k1(),n,t,e,o),Z1(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:j8(n,t,e,o,function(a,r){return De(i,a,r)}):!1}function Zt(n,t,e,o,i){return!!(P8(n,t,e,o,i)||x0(n,t,e,o,i[0],i[1])||x0(n,t,e,o,i[0],i[3])||x0(n,t,e,o,i[2],i[1])||x0(n,t,e,o,i[2],i[3]))}function D8(n,t,e,o,i){if(!Zt(n,t,e[0],o,i))return!1;if(e.length===1)return!0;for(let s=1,a=e.length;s<a;++s)if(b8(n,e[s-1],e[s],o,i)&&!P8(n,e[s-1],e[s],o,i))return!1;return!0}function F8(n,t,e,o){for(;t<e-o;){for(let i=0;i<o;++i){let s=n[t+i];n[t+i]=n[e-o+i],n[e-o+i]=s}t+=o,e-=o}}function N8(n,t,e,o){let i=0,s=n[e-o],a=n[e-o+1];for(;t<e;t+=o){let r=n[t],l=n[t+1];i+=(r-s)*(l+a),s=r,a=l}return i===0?void 0:i>0}function q8(n,t,e,o,i){i=i!==void 0?i:!1;for(let s=0,a=e.length;s<a;++s){let r=e[s],l=N8(n,t,r,o);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;t=r}return!0}function $t(n,t,e,o,i){i=i!==void 0?i:!1;for(let s=0,a=e.length;s<a;++s){let r=e[s],l=N8(n,t,r,o);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&F8(n,t,r,o),t=r}return t}var k4=class n extends t2{constructor(t,e,o){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&o?(this.setFlatCoordinates(e,t),this.ends_=o):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?me(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let t=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,o,i){return i<c4(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(B8(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),S8(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,o,i))}containsXY(t,e){return z4(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return L8(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),$t(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,H8(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){let t=j1(this.getExtent());this.flatInteriorPoint_=I8(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new T8(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Yt(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){let t=this.layout,e=this.flatCoordinates,o=this.ends_,i=[],s=0;for(let a=0,r=o.length;a<r;++a){let l=o[a],c=new Yt(e.slice(s,l),t);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let t=this.flatCoordinates;q8(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=$t(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){let e=[],o=[];return e.length=R8(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,o),new n(e,"XY",o)}getType(){return"Polygon"}intersectsExtent(t){return D8(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);let o=V8(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=o.length===0?0:o[o.length-1],this.changed()}},U8=k4;function Jt(n){if(p0(n))throw new Error("Cannot create polygon from empty extent");let t=n[0],e=n[1],o=n[2],i=n[3],s=[t,e,t,i,o,i,o,e,t,e];return new k4(s,"XY",[s.length])}function Qt(n,t,e,o){let i=I(t)/e[0],s=J(t)/e[1];return o?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function t3(n,t,e){let o=Math.min(n,t),i=50;return o*=Math.log(1+i*Math.max(0,n/t-1))/i+1,e&&(o=Math.max(o,e),o/=Math.log(1+i*Math.max(0,e/n-1))/i+1),N(o,e/2,t*2)}function G8(n,t,e,o){return t=t!==void 0?t:!0,(function(i,s,a,r){if(i!==void 0){let l=n[0],c=n[n.length-1],h=e?Qt(l,e,a,o):l;if(r)return t?t3(i,h,c):N(i,c,h);let g=Math.min(h,i),d=Math.floor(D0(n,g,s));return n[d]>h&&d<n.length-1?n[d+1]:n[d]}})}function X8(n,t,e,o,i,s){return o=o!==void 0?o:!0,e=e!==void 0?e:0,(function(a,r,l,c){if(a!==void 0){let h=i?Qt(t,i,l,s):t;if(c)return o?t3(a,h,e):N(a,e,h);let g=1e-9,d=Math.ceil(Math.log(t/h)/Math.log(n)-g),w=-r*(.5-g)+.5,v=Math.min(h,a),m=Math.floor(Math.log(t/v)/Math.log(n)+w),p=Math.max(d,m),x=t/Math.pow(n,p);return N(x,e,h)}})}function e3(n,t,e,o,i){return e=e!==void 0?e:!0,(function(s,a,r,l){if(s!==void 0){let c=o?Qt(n,o,r,i):n;return!e||!l?N(s,t,c):t3(s,c,t)}})}function n2(n){if(n!==void 0)return 0}function n3(n){if(n!==void 0)return n}function K8(n){let t=2*Math.PI/n;return(function(e,o){if(o)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e})}function Y8(n){let t=n===void 0?A1(5):n;return(function(e,o){return o||e===void 0?e:Math.abs(e)<=t?0:e})}var o3=0,s3=class extends Q{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=x4(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Rt(),t.center&&(t.center=B1(t.center,this.projection_)),t.extent&&(t.extent=t0(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){let e=Object.assign({},t);for(let r in z1)delete e[r];this.setProperties(e,!0);let o=Mi(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=o.minZoom;let i=fi(t),s=o.constraint,a=zi(t);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;let o=this.getCenterInternal();if(o){let i=t||[0,0,0,0];e=e||[0,0,0,0];let s=this.getResolution(),a=s/2*(i[3]-e[3]+e[1]-i[1]),r=s/2*(i[0]-e[0]+e[2]-i[2]);this.setCenterInternal([o[0]+a,o[1]-r])}}getUpdatedOptions_(t){let e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);let e=new Array(arguments.length);for(let o=0;o<e.length;++o){let i=arguments[o];i.center&&(i=Object.assign({},i),i.center=B1(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=B1(i.anchor,this.getProjection())),e[o]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,o;e>1&&typeof arguments[e-1]=="function"&&(o=arguments[e-1],--e);let i=0;for(;i<e&&!this.isDef();++i){let h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===e){o&&y4(o,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),r=this.targetResolution_,l=this.targetRotation_,c=[];for(;i<e;++i){let h=arguments[i],g={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||Ke,callback:o};if(h.center&&(g.sourceCenter=a,g.targetCenter=h.center.slice(),a=g.targetCenter),h.zoom!==void 0?(g.sourceResolution=r,g.targetResolution=this.getResolutionForZoom(h.zoom),r=g.targetResolution):h.resolution&&(g.sourceResolution=r,g.targetResolution=h.resolution,r=g.targetResolution),h.rotation!==void 0){g.sourceRotation=l;let d=W1(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=l+d,l=g.targetRotation}ki(g)?g.complete=!0:s+=g.duration,c.push(g)}this.animations_.push(c),this.setHint(v1.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[v1.ANIMATING]>0}getInteracting(){return this.hints_[v1.INTERACTING]>0}cancelAnimations(){this.setHint(v1.ANIMATING,-this.hints_[v1.ANIMATING]);let t;for(let e=0,o=this.animations_.length;e<o;++e){let i=this.animations_[e];if(i[0].callback&&y4(i[0].callback,!1),!t)for(let s=0,a=i.length;s<a;++s){let r=i[s];if(!r.complete){t=r.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;let t=Date.now(),e=!1;for(let o=this.animations_.length-1;o>=0;--o){let i=this.animations_[o],s=!0;for(let a=0,r=i.length;a<r;++a){let l=i[a];if(l.complete)continue;let c=t-l.start,h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;let g=l.easing(h);if(l.sourceCenter){let d=l.sourceCenter[0],w=l.sourceCenter[1],v=l.targetCenter[0],m=l.targetCenter[1];this.nextCenter_=l.targetCenter;let p=d+g*(v-d),x=w+g*(m-w);this.targetCenter_=[p,x]}if(l.sourceResolution&&l.targetResolution){let d=g===1?l.targetResolution:l.sourceResolution+g*(l.targetResolution-l.sourceResolution);if(l.anchor){let w=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(d,0,w,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){let d=g===1?W1(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+g*(l.targetRotation-l.sourceRotation);if(l.anchor){let w=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(w,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[o]=null,this.setHint(v1.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;let a=i[0].callback;a&&y4(a,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let o,i=this.getCenterInternal();return i!==void 0&&(o=[i[0]-e[0],i[1]-e[1]],Y0(o,t-this.getRotation()),qe(o,e)),o}calculateCenterZoom(t,e){let o,i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){let a=e[0]-t*(e[0]-i[0])/s,r=e[1]-t*(e[1]-i[1])/s;o=[a,r]}return o}getViewportSize_(t){let e=this.viewportSize_;if(t){let o=e[0],i=e[1];return[Math.abs(o*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(o*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){let t=this.getCenterInternal();return t&&V2(t,this.getProjection())}getCenterInternal(){return this.get(z1.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){let e=this.calculateExtentInternal(t);return p8(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();let e=this.getCenterInternal();T(e,"The view center is not defined");let o=this.getResolution();T(o!==void 0,"The view resolution is not defined");let i=this.getRotation();return T(i!==void 0,"The view rotation is not defined"),S2(e,o,i,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(z1.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(t0(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();let o=I(t)/e[0],i=J(t)/e[1];return Math.max(o,i)}getResolutionForValueFunction(t){t=t||2;let e=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,i=Math.log(e/o)/Math.log(t);return(function(s){return e/Math.pow(t,s*i)})}getRotation(){return this.get(z1.ROTATION)}getValueForResolutionFunction(t){let e=Math.log(t||2),o=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(o/i)/e;return(function(a){return Math.log(o/a)/e/s})}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t),o=this.padding_;return o&&(e=[e[0]-o[1]-o[3],e[1]-o[0]-o[2]]),e}getState(){let t=this.getProjection(),e=this.getResolution(),o=this.getRotation(),i=this.getCenterInternal(),s=this.padding_;if(s){let a=this.getViewportSizeMinusPadding_();i=i3(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],e,o)}return{center:i.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:o,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t,e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,o,i;if(this.resolutions_){let s=D0(this.resolutions_,t,1);e=s,o=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=o/this.resolutions_[s+1]}else o=this.maxResolution_,i=this.zoomFactor_;return e+Math.log(o/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];let e=N(Math.floor(t),0,this.resolutions_.length-2),o=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(o,N(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let o;if(T(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){T(!p0(t),"Cannot fit empty extent provided as `geometry`");let i=t0(t,this.getProjection());o=Jt(i)}else if(t.getType()==="Circle"){let i=t0(t.getExtent(),this.getProjection());o=Jt(i),o.rotate(this.getRotation(),j1(i))}else{let i=u8();i?o=t.clone().transform(i,this.getProjection()):o=t}this.fitInternal(o,e)}rotatedExtentForGeometry(t){let e=this.getRotation(),o=Math.cos(e),i=Math.sin(-e),s=t.getFlatCoordinates(),a=t.getStride(),r=1/0,l=1/0,c=-1/0,h=-1/0;for(let g=0,d=s.length;g<d;g+=a){let w=s[g]*o-s[g+1]*i,v=s[g]*i+s[g+1]*o;r=Math.min(r,w),l=Math.min(l,v),c=Math.max(c,w),h=Math.max(h,v)}return[r,l,c,h]}fitInternal(t,e){e=e||{};let o=e.size;o||(o=this.getViewportSizeMinusPadding_());let i=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1,a;e.minResolution!==void 0?a=e.minResolution:e.maxZoom!==void 0?a=this.getResolutionForZoom(e.maxZoom):a=0;let r=this.rotatedExtentForGeometry(t),l=this.getResolutionForExtentInternal(r,[o[0]-i[1]-i[3],o[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);let c=this.getRotation(),h=Math.sin(c),g=Math.cos(c),d=j1(r);d[0]+=(i[1]-i[3])/2*l,d[1]+=(i[0]-i[2])/2*l;let w=d[0]*g-d[1]*h,v=d[1]*g+d[0]*h,m=this.getConstrainedCenter([w,v],l),p=e.callback?e.callback:B0;e.duration!==void 0?this.animateInternal({resolution:l,center:m,duration:e.duration,easing:e.easing},p):(this.targetResolution_=l,this.targetCenter_=m,this.applyTargetState_(!1,!0),y4(p,!0))}centerOn(t,e,o){this.centerOnInternal(B1(t,this.getProjection()),e,o)}centerOnInternal(t,e,o){this.setCenterInternal(i3(t,e,o,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,o,i){let s,a=this.padding_;if(a&&t){let r=this.getViewportSizeMinusPadding_(-o),l=i3(t,i,[r[0]/2+a[3],r[1]/2+a[0]],e,o);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){let e=V2(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){let e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&B1(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){let o=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,i,o);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=B1(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){let o=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,o);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&B1(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){let o=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,o),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,o),r=this.constraints_.center(this.targetCenter_,a,s,o,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(z1.ROTATION)!==i&&this.set(z1.ROTATION,i),this.get(z1.RESOLUTION)!==a&&(this.set(z1.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!r||!this.get(z1.CENTER)||!V0(this.get(z1.CENTER),r))&&this.set(z1.CENTER,r),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,o){t=t!==void 0?t:200;let i=e||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),r=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,r,a,!1,this.calculateCenterShift(this.targetCenter_,r,s,a));if(t===0&&!this.cancelAnchor_){this.targetResolution_=r,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}o=o||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==r||this.getRotation()!==s||!this.getCenterInternal()||!V0(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:r,duration:t,easing:_1,anchor:o}))}beginInteraction(){this.resolveConstraints(0),this.setHint(v1.INTERACTING,1)}endInteraction(t,e,o){o=o&&B1(o,this.getProjection()),this.endInteractionInternal(t,e,o)}endInteractionInternal(t,e,o){this.getInteracting()&&(this.setHint(v1.INTERACTING,-1),this.resolveConstraints(t,e,o))}getConstrainedCenter(t,e){let o=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),o)}getConstrainedZoom(t,e){let o=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(o,e))}getConstrainedResolution(t,e){e=e||0;let o=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,o)}};function y4(n,t){setTimeout(function(){n(t)},0)}function fi(n){if(n.extent!==void 0){let e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return xt(n.extent,n.constrainOnlyCenter,e)}let t=x4(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){let e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,xt(e,!1,!1)}return He}function Mi(n){let t,e,o,a=n.minZoom!==void 0?n.minZoom:o3,r=n.maxZoom!==void 0?n.maxZoom:28,l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,d=x4(n.projection,"EPSG:3857"),w=d.getExtent(),v=n.constrainOnlyCenter,m=n.extent;if(!c&&!m&&d.isGlobal()&&(v=!1,m=w),n.resolutions!==void 0){let p=n.resolutions;e=p[a],o=p[r]!==void 0?p[r]:p[p.length-1],n.constrainResolution?t=G8(p,h,!v&&m,g):t=e3(e,o,h,!v&&m,g)}else{let x=(w?Math.max(I(w),J(w)):360*$1.degrees/d.getMetersPerUnit())/256/Math.pow(2,o3),M=x/Math.pow(2,28-o3);e=n.maxResolution,e!==void 0?a=0:e=x/Math.pow(l,a),o=n.minResolution,o===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?o=e/Math.pow(l,r):o=x/Math.pow(l,r):o=M),r=a+Math.floor(Math.log(e/o)/Math.log(l)),o=e/Math.pow(l,r-a),n.constrainResolution?t=X8(l,e,o,h,!v&&m,g):t=e3(e,o,h,!v&&m,g)}return{constraint:t,maxResolution:e,minResolution:o,minZoom:a,zoomFactor:l}}function zi(n){if(n.enableRotation!==void 0?n.enableRotation:!0){let e=n.constrainRotation;return e===void 0||e===!0?Y8():e===!1?n3:typeof e=="number"?K8(e):n3}return n2}function ki(n){return!(n.sourceCenter&&n.targetCenter&&!V0(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function i3(n,t,e,o,i){let s=Math.cos(-i),a=Math.sin(-i),r=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;r+=(t[0]/2-e[0])*o,l+=(e[1]-t[1]/2)*o,a=-a;let c=r*s-l*a,h=l*s+r*a;return[c,h]}var w1=s3;var H2="ol-hidden";var f0="ol-unselectable";var o2="ol-control",a3="ol-collapsed",B7=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i");function K(n,t,e,o){let i;return e&&e.length?i=e.shift():_e?i=new OffscreenCanvas(n||300,t||300):i=document.createElement("canvas"),n&&(i.width=n),t&&(i.height=t),i.getContext("2d",o)}var r3;function i2(){return r3||(r3=K(1,1)),r3}function O2(n){let t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function l3(n,t){let e=t.parentNode;e&&e.replaceChild(n,t)}function Z8(n){for(;n.lastChild;)n.lastChild.remove()}function $8(n,t){let e=n.childNodes;for(let o=0;;++o){let i=e[o],s=t[o];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--o;continue}n.insertBefore(s,i)}}}var c3=class extends Q{constructor(t){super();let e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let e=0,o=this.listenerKeys.length;e<o;++e)F(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){let e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==B0&&this.listenerKeys.push(R(t,I1.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}},s2=c3;var h3=class extends s2{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;let e=t.className!==void 0?t.className:"ol-attribution",o=t.tipLabel!==void 0?t.tipLabel:"Attributions",i=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"\u203A",a=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;let r=t.label!==void 0?t.label:"i";typeof r=="string"?(this.label_=document.createElement("span"),this.label_.textContent=r,this.label_.className=i):this.label_=r;let l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=o,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(_.CLICK,this.handleClick_.bind(this),!1);let c=e+" "+f0+" "+o2+(this.collapsed_&&this.collapsible_?" "+a3:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){let e=this.getMap().getAllLayers(),o=new Set(e.flatMap(i=>i.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>o.add(i)):o.add(this.attributions_)),!this.overrideCollapsible_){let i=!e.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(o)}updateElement_(t){return L1(this,null,function*(){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}let e=yield Promise.all(this.collectSourceAttributions_(t).map(i=>Me(()=>i))),o=e.length>0;if(this.renderedVisible_!=o&&(this.element.style.display=o?"":"none",this.renderedVisible_=o),!g0(e,this.renderedAttributions_)){Z8(this.ulElement_);for(let i=0,s=e.length;i<s;++i){let a=document.createElement("li");a.innerHTML=e[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=e}})}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(a3),this.collapsed_?l3(this.collapseLabel_,this.label_):l3(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},J8=h3;var g3=class extends s2{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});let e=t.className!==void 0?t.className:"ol-rotate",o=t.label!==void 0?t.label:"\u21E7",i=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof o=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=o):(this.label_=o,this.label_.classList.add(i));let s=t.tipLabel?t.tipLabel:"Reset rotation",a=document.createElement("button");a.className=e+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(_.CLICK,this.handleClick_.bind(this),!1);let r=e+" "+f0+" "+o2,l=this.element;l.className=r,l.appendChild(a),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(H2)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){let e=this.getMap().getView();if(!e)return;let o=e.getRotation();o!==void 0&&(this.duration_>0&&o%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:_1}):e.setRotation(0))}render(t){let e=t.frameState;if(!e)return;let o=e.viewState.rotation;if(o!=this.rotation_){let i="rotate("+o+"rad)";if(this.autoHide_){let s=this.element.classList.contains(H2);!s&&o===0?this.element.classList.add(H2):s&&o!==0&&this.element.classList.remove(H2)}this.label_.style.transform=i}this.rotation_=o}},Q8=g3;var d3=class extends s2{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});let e=t.className!==void 0?t.className:"ol-zoom",o=t.delta!==void 0?t.delta:1,i=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",a=t.zoomInLabel!==void 0?t.zoomInLabel:"+",r=t.zoomOutLabel!==void 0?t.zoomOutLabel:"\u2013",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(_.CLICK,this.handleClick_.bind(this,o),!1);let g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof r=="string"?document.createTextNode(r):r),g.addEventListener(_.CLICK,this.handleClick_.bind(this,-o),!1);let d=e+" "+f0+" "+o2,w=this.element;w.className=d,w.appendChild(h),w.appendChild(g),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){let o=this.getMap().getView();if(!o)return;let i=o.getZoom();if(i!==void 0){let s=o.getConstrainedZoom(i+t);this.duration_>0?(o.getAnimating()&&o.cancelAnimations(),o.animate({zoom:s,duration:this.duration_,easing:_1})):o.setZoom(s)}}},tn=d3;function en(n){n=n||{};let t=new m1;return(n.zoom!==void 0?n.zoom:!0)&&t.push(new tn(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&t.push(new Q8(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&t.push(new J8(n.attributionOptions)),t}var v3=class{constructor(t,e,o){this.decay_=t,this.minVelocity_=e,this.delay_=o,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;let t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let o=e-3;for(;o>0&&this.points_[o+2]>t;)o-=3;let i=this.points_[e+2]-this.points_[o+2];if(i<1e3/60)return!1;let s=this.points_[e]-this.points_[o],a=this.points_[e+1]-this.points_[o+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},nn=v3;var w3={ACTIVE:"active"};var u3=class extends Q{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(w3.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(w3.ACTIVE,t)}setMap(t){this.map_=t}};function on(n,t,e){let o=n.getCenterInternal();if(o){let i=[o[0]+t[0],o[1]+t[1]];n.animateInternal({duration:e!==void 0?e:250,easing:Ye,center:n.getConstrainedCenter(i)})}}function a2(n,t,e,o){let i=n.getZoom();if(i===void 0)return;let s=n.getConstrainedZoom(i+t),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:e,duration:o!==void 0?o:250,easing:_1})}var D1=u3;var p3=class extends D1{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==U.DBLCLICK){let o=t.originalEvent,i=t.map,s=t.coordinate,a=o.shiftKey?-this.delta_:this.delta_,r=i.getView();a2(r,a,s,this.duration_),o.preventDefault(),e=!0}return!e}},sn=p3;function R2(n){let t=arguments;return function(e){let o=!0;for(let i=0,s=t.length;i<s&&(o=o&&t[i](e),!!o);++i);return o}}var an=function(n){let t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},yi=function(n){let t=n.map.getTargetElement(),e=t.getRootNode(),o=n.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(o):t.contains(o)},_4=function(n){let t=n.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?yi(n):!0},rn=A0;var C4=function(n){let t=n.originalEvent;return"pointerId"in t&&t.button==0&&!(ke&&vt&&t.ctrlKey)};var L4=function(n){let t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var ln=function(n){let t=n.originalEvent;return vt?t.metaKey:t.ctrlKey},cn=function(n){let t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},A4=function(n){let t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},B4=function(n){let t=n.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"};var hn=function(n){let t=n.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};var m3=class extends D1{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==U.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==U.POINTERUP){let o=this.handleUpEvent(t);this.handlingDownUpSequence=o&&this.targetPointers.length>0}}else if(t.type==U.POINTERDOWN){let o=this.handleDownEvent(t);this.handlingDownUpSequence=o,e=this.stopDown(o)}else t.type==U.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function r2(n){let t=n.length,e=0,o=0;for(let i=0;i<t;i++)e+=n[i].clientX,o+=n[i].clientY;return{clientX:e/t,clientY:o/t}}var F1=m3;var x3=class extends F1{constructor(t){super({stopDown:K1}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;let e=t.condition?t.condition:R2(L4,hn);this.condition_=t.onFocusOnly?R2(_4,e):e,this.noKinetic_=!1}handleDragEvent(t){let e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());let o=this.targetPointers,i=e.getEventPixel(r2(o));if(o.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){let s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],r=t.map.getView();Ue(s,r.getResolution()),Y0(s,r.getRotation()),r.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=o.length,t.originalEvent.preventDefault()}handleUpEvent(t){let e=t.map,o=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=o.getCenterInternal(),r=e.getPixelFromCoordinateInternal(a),l=e.getCoordinateFromPixelInternal([r[0]-i*Math.cos(s),r[1]-i*Math.sin(s)]);o.animateInternal({center:o.getConstrainedCenter(l),duration:500,easing:_1})}return this.panning_&&(this.panning_=!1,o.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){let o=t.map.getView();return this.lastCentroid=null,o.getAnimating()&&o.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},gn=x3;var f3=class extends F1{constructor(t){t=t||{},super({stopDown:K1}),this.condition_=t.condition?t.condition:an,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!B4(t))return;let e=t.map,o=e.getView();if(o.getConstraints().rotation===n2)return;let i=e.getSize(),s=t.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){let r=a-this.lastAngle_;o.adjustRotationInternal(-r)}this.lastAngle_=a}handleUpEvent(t){return B4(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return B4(t)&&C4(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}},dn=f3;var M3=class extends h0{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){let t=this.startPixel_,e=this.endPixel_,o="px",i=this.element_.style;i.left=Math.min(t[0],e[0])+o,i.top=Math.min(t[1],e[1])+o,i.width=Math.abs(e[0]-t[0])+o,i.height=Math.abs(e[1]-t[1])+o}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;let t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new U8([i])}getGeometry(){return this.geometry_}},vn=M3;var l2={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},T0=class extends a1{constructor(t,e,o){super(t),this.coordinate=e,this.mapBrowserEvent=o}},z3=class extends F1{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new vn(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??C4,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,o){let i=o[0]-e[0],s=o[1]-e[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new T0(l2.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;let e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new T0(e?l2.BOXEND:l2.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new T0(l2.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new T0(l2.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new T0(l2.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}},wn=z3;var k3=class extends wn{constructor(t){t=t||{};let e=t.condition?t.condition:cn;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){let o=this.getMap().getView(),i=this.getGeometry();if(this.out_){let s=o.rotatedExtentForGeometry(i),a=o.getResolutionForExtentInternal(s),r=o.getResolution()/a;i=i.clone(),i.scale(r*r)}o.fitInternal(i,{duration:this.duration_,easing:_1})}},un=k3;var M0={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};var y3=class extends D1{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return L4(e)&&A4(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==_.KEYDOWN){let o=t.originalEvent,i=o.key;if(this.condition_(t)&&(i==M0.DOWN||i==M0.LEFT||i==M0.RIGHT||i==M0.UP)){let a=t.map.getView(),r=a.getResolution()*this.pixelDelta_,l=0,c=0;i==M0.DOWN?c=-r:i==M0.LEFT?l=-r:i==M0.RIGHT?l=r:c=r;let h=[l,c];Y0(h,a.getRotation()),on(a,h,this.duration_),o.preventDefault(),e=!0}}return!e}},pn=y3;var _3=class extends D1{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!ln(e)&&A4(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==_.KEYDOWN||t.type==_.KEYPRESS){let o=t.originalEvent,i=o.key;if(this.condition_(t)&&(i==="+"||i==="-")){let s=t.map,a=i==="+"?this.delta_:-this.delta_,r=s.getView();a2(r,a,void 0,this.duration_),o.preventDefault(),e=!0}}return!e}},mn=_3;var _i=40,Ci=300,C3=class extends D1{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;let e=t.condition?t.condition:rn;this.condition_=t.onFocusOnly?R2(_4,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;let t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==_.WHEEL)return!0;let o=t.map,i=t.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=_i;break;case WheelEvent.DOM_DELTA_PAGE:s*=Ci;break;default:}if(s===0)return!1;this.lastDelta_=s;let a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");let r=o.getView();if(this.mode_==="trackpad"&&!(r.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(r.getAnimating()&&r.cancelAnimations(),r.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),r.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?o.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;let l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),l),!1}handleWheelZoom_(t){let e=t.getView();e.getAnimating()&&e.cancelAnimations();let o=-N(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(o=o?o>0?1:-1:0),a2(e,o,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},xn=C3;var L3=class extends F1{constructor(t){t=t||{};let e=t;e.stopDown||(e.stopDown=K1),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0,o=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-o.clientY,i.clientX-o.clientX);if(this.lastAngle_!==void 0){let l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;let a=t.map,r=a.getView();r.getConstraints().rotation!==n2&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(r2(this.targetPointers))),this.rotating_&&(a.render(),r.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){let e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},fn=L3;var A3=class extends F1{constructor(t){t=t||{};let e=t;e.stopDown||(e.stopDown=K1),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1,o=this.targetPointers[0],i=this.targetPointers[1],s=o.clientX-i.clientX,a=o.clientY-i.clientY,r=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(e=this.lastDistance_/r),this.lastDistance_=r;let l=t.map,c=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(r2(this.targetPointers))),l.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){let o=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return o.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){let e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Mn=A3;function zn(n){n=n||{};let t=new m1,e=new nn(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&t.push(new dn),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&t.push(new sn({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&t.push(new gn({onFocusOnly:n.onFocusOnly,kinetic:e})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&t.push(new fn),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&t.push(new Mn({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(t.push(new pn),t.push(new mn({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&t.push(new xn({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&t.push(new un({duration:n.zoomDuration})),t}var P={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var B3=class extends Q{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;let e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[P.OPACITY]=t.opacity!==void 0?t.opacity:1,T(typeof e[P.OPACITY]=="number","Layer opacity must be a number"),e[P.VISIBLE]=t.visible!==void 0?t.visible:!0,e[P.Z_INDEX]=t.zIndex,e[P.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[P.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[P.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[P.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){let e=this.state_||{layer:this,managed:t===void 0?!0:t},o=this.getZIndex();return e.opacity=N(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=o===void 0&&!e.managed?1/0:o,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return O()}getLayerStatesArray(t){return O()}getExtent(){return this.get(P.EXTENT)}getMaxResolution(){return this.get(P.MAX_RESOLUTION)}getMinResolution(){return this.get(P.MIN_RESOLUTION)}getMinZoom(){return this.get(P.MIN_ZOOM)}getMaxZoom(){return this.get(P.MAX_ZOOM)}getOpacity(){return this.get(P.OPACITY)}getSourceState(){return O()}getVisible(){return this.get(P.VISIBLE)}getZIndex(){return this.get(P.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(P.EXTENT,t)}setMaxResolution(t){this.set(P.MAX_RESOLUTION,t)}setMinResolution(t){this.set(P.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(P.MAX_ZOOM,t)}setMinZoom(t){this.set(P.MIN_ZOOM,t)}setOpacity(t){T(typeof t=="number","Layer opacity must be a number"),this.set(P.OPACITY,t)}setVisible(t){this.set(P.VISIBLE,t)}setZIndex(t){this.set(P.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},S4=B3;var S1=class extends a1{constructor(t,e){super(t),this.layer=e}},S3={LAYERS:"layers"},E3=class n extends S4{constructor(t){t=t||{};let e=Object.assign({},t);delete e.layers;let o=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(S3.LAYERS,this.handleLayersChanged_),o?Array.isArray(o)?o=new m1(o.slice(),{unique:!0}):T(typeof o.getArray=="function","Expected `layers` to be an array or a `Collection`"):o=new m1(void 0,{unique:!0}),this.setLayers(o)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(F),this.layersListenerKeys_.length=0;let t=this.getLayers();this.layersListenerKeys_.push(R(t,h1.ADD,this.handleLayersAdd_,this),R(t,h1.REMOVE,this.handleLayersRemove_,this));for(let o in this.listenerKeys_)this.listenerKeys_[o].forEach(F);d0(this.listenerKeys_);let e=t.getArray();for(let o=0,i=e.length;o<i;o++){let s=e[o];this.registerLayerListeners_(s),this.dispatchEvent(new S1("addlayer",s))}this.changed()}registerLayerListeners_(t){let e=[R(t,X1.PROPERTYCHANGE,this.handleLayerChange_,this),R(t,_.CHANGE,this.handleLayerChange_,this)];t instanceof n&&e.push(R(t,"addlayer",this.handleLayerGroupAdd_,this),R(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[q(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new S1("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new S1("removelayer",t.layer))}handleLayersAdd_(t){let e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new S1("addlayer",e)),this.changed()}handleLayersRemove_(t){let e=t.element,o=q(e);this.listenerKeys_[o].forEach(F),delete this.listenerKeys_[o],this.dispatchEvent(new S1("removelayer",e)),this.changed()}getLayers(){return this.get(S3.LAYERS)}setLayers(t){let e=this.getLayers();if(e){let o=e.getArray();for(let i=0,s=o.length;i<s;++i)this.dispatchEvent(new S1("removelayer",o[i]))}this.set(S3.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){let e=t!==void 0?t:[],o=e.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(e)});let i=this.getLayerState(),s=i.zIndex;!t&&i.zIndex===void 0&&(s=0);for(let a=o,r=e.length;a<r;a++){let l=e[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=P1(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}},T2=E3;var u1={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var V3=class extends S4{constructor(t){let e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(P.SOURCE,this.handleSourcePropertyChange_);let o=t.source?t.source:null;this.setSource(o)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(P.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){let t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(F(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;let t=this.getSource();t&&(this.sourceChangeKey_=R(t,_.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e,o=this.getMapInternal();!t&&o&&(t=o.getView()),t instanceof w1?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&o&&(e.layerStatesArray=o.getLayerGroup().getLayerStatesArray());let i;if(e.layerStatesArray){if(i=e.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();let s=this.getExtent();return b2(i,e.viewState)&&(!s||Z1(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e=this.getSource()?.getAttributions();if(!e)return[];let o=t instanceof w1?t.getViewStateAndExtent():t,i=e(o);return Array.isArray(i)||(i=[i]),i}render(t,e){let o=this.getRenderer();return o.prepareFrame(t)?(this.rendered=!0,o.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){let e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(P.MAP,t)}getMapInternal(){return this.get(P.MAP)}setMap(t){this.mapPrecomposeKey_&&(F(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(F(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=R(t,u1.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=R(this,_.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){let e=t.frameState.layerStatesArray,o=this.getLayerState(!1);T(!e.some(i=>i.layer===o.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(o)}setSource(t){this.set(P.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function b2(n,t){if(!n.visible)return!1;let e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;let o=t.zoom;return o>n.minZoom&&o<=n.maxZoom}var b0=V3;function E4(n,t,e=0,o=n.length-1,i=Li){for(;o>e;){if(o-e>600){let l=o-e+1,c=t-e+1,h=Math.log(l),g=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*g*(l-g)/l)*(c-l/2<0?-1:1),w=Math.max(e,Math.floor(t-c*g/l+d)),v=Math.min(o,Math.floor(t+(l-c)*g/l+d));E4(n,t,w,v,i)}let s=n[t],a=e,r=o;for(I2(n,e,t),i(n[o],s)>0&&I2(n,e,o);a<r;){for(I2(n,a,r),a++,r--;i(n[a],s)<0;)a++;for(;i(n[r],s)>0;)r--}i(n[e],s)===0?I2(n,e,r):(r++,I2(n,r,o)),r<=t&&(e=r+1),t<=r&&(o=r-1)}}function I2(n,t,e){let o=n[t];n[t]=n[e],n[e]=o}function Li(n,t){return n<t?-1:n>t?1:0}var O4=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data,o=[];if(!H4(t,e))return o;let i=this.toBBox,s=[];for(;e;){for(let a=0;a<e.children.length;a++){let r=e.children[a],l=e.leaf?i(r):r;H4(t,l)&&(e.leaf?o.push(r):O3(t,l)?this._all(r,o):s.push(r))}e=s.pop()}return o}collides(t){let e=this.data;if(!H4(t,e))return!1;let o=[];for(;e;){for(let i=0;i<e.children.length;i++){let s=e.children[i],a=e.leaf?this.toBBox(s):s;if(H4(t,a)){if(e.leaf||O3(t,a))return!0;o.push(s)}}e=o.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let o=0;o<t.length;o++)this.insert(t[o]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){let o=this.data;this.data=e,e=o}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=h2([]),this}remove(t,e){if(!t)return this;let o=this.data,i=this.toBBox(t),s=[],a=[],r,l,c;for(;o||s.length;){if(o||(o=s.pop(),l=s[s.length-1],r=a.pop(),c=!0),o.leaf){let h=Ai(t,o.children,e);if(h!==-1)return o.children.splice(h,1),s.push(o),this._condense(s),this}!c&&!o.leaf&&O3(o,i)?(s.push(o),a.push(r),r=0,l=o,o=o.children[0]):l?(r++,o=l.children[r],c=!1):o=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){let o=[];for(;t;)t.leaf?e.push(...t.children):o.push(...t.children),t=o.pop();return e}_build(t,e,o,i){let s=o-e+1,a=this._maxEntries,r;if(s<=a)return r=h2(t.slice(e,o+1)),c2(r,this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),r=h2([]),r.leaf=!1,r.height=i;let l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));kn(t,e,o,c,this.compareMinX);for(let h=e;h<=o;h+=c){let g=Math.min(h+c-1,o);kn(t,h,g,l,this.compareMinY);for(let d=h;d<=g;d+=l){let w=Math.min(d+l-1,g);r.children.push(this._build(t,d,w,i-1))}}return c2(r,this.toBBox),r}_chooseSubtree(t,e,o,i){for(;i.push(e),!(e.leaf||i.length-1===o);){let s=1/0,a=1/0,r;for(let l=0;l<e.children.length;l++){let c=e.children[l],h=H3(c),g=Ei(t,c)-h;g<a?(a=g,s=h<s?h:s,r=c):g===a&&h<s&&(s=h,r=c)}e=r||e.children[0]}return e}_insert(t,e,o){let i=o?t:this.toBBox(t),s=[],a=this._chooseSubtree(i,this.data,e,s);for(a.children.push(t),P2(a,i);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(i,s,e)}_split(t,e){let o=t[e],i=o.children.length,s=this._minEntries;this._chooseSplitAxis(o,s,i);let a=this._chooseSplitIndex(o,s,i),r=h2(o.children.splice(a,o.children.length-a));r.height=o.height,r.leaf=o.leaf,c2(o,this.toBBox),c2(r,this.toBBox),e?t[e-1].children.push(r):this._splitRoot(o,r)}_splitRoot(t,e){this.data=h2([t,e]),this.data.height=t.height+1,this.data.leaf=!1,c2(this.data,this.toBBox)}_chooseSplitIndex(t,e,o){let i,s=1/0,a=1/0;for(let r=e;r<=o-e;r++){let l=j2(t,0,r,this.toBBox),c=j2(t,r,o,this.toBBox),h=Vi(l,c),g=H3(l)+H3(c);h<s?(s=h,i=r,a=g<a?g:a):h===s&&g<a&&(a=g,i=r)}return i||o-e}_chooseSplitAxis(t,e,o){let i=t.leaf?this.compareMinX:Bi,s=t.leaf?this.compareMinY:Si,a=this._allDistMargin(t,e,o,i),r=this._allDistMargin(t,e,o,s);a<r&&t.children.sort(i)}_allDistMargin(t,e,o,i){t.children.sort(i);let s=this.toBBox,a=j2(t,0,e,s),r=j2(t,o-e,o,s),l=V4(a)+V4(r);for(let c=e;c<o-e;c++){let h=t.children[c];P2(a,t.leaf?s(h):h),l+=V4(a)}for(let c=o-e-1;c>=e;c--){let h=t.children[c];P2(r,t.leaf?s(h):h),l+=V4(r)}return l}_adjustParentBBoxes(t,e,o){for(let i=o;i>=0;i--)P2(e[i],t)}_condense(t){for(let e=t.length-1,o;e>=0;e--)t[e].children.length===0?e>0?(o=t[e-1].children,o.splice(o.indexOf(t[e]),1)):this.clear():c2(t[e],this.toBBox)}};function Ai(n,t,e){if(!e)return t.indexOf(n);for(let o=0;o<t.length;o++)if(e(n,t[o]))return o;return-1}function c2(n,t){j2(n,0,n.children.length,t,n)}function j2(n,t,e,o,i){i||(i=h2(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=t;s<e;s++){let a=n.children[s];P2(i,n.leaf?o(a):a)}return i}function P2(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function Bi(n,t){return n.minX-t.minX}function Si(n,t){return n.minY-t.minY}function H3(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function V4(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Ei(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function Vi(n,t){let e=Math.max(n.minX,t.minX),o=Math.max(n.minY,t.minY),i=Math.min(n.maxX,t.maxX),s=Math.min(n.maxY,t.maxY);return Math.max(0,i-e)*Math.max(0,s-o)}function O3(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function H4(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function h2(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function kn(n,t,e,o,i){let s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=o)continue;let a=t+Math.ceil((e-t)/o/2)*o;E4(n,a,t,e,i),s.push(t,a,a,e)}}var T4=[NaN,NaN,NaN,0],R3;function Hi(){return R3||(R3=K(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),R3}var Oi=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Ri=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Ti=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,bi=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function R4(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function F2(n){throw new Error('failed to parse "'+n+'" as color')}function yn(n){if(n.toLowerCase().startsWith("rgb")){let s=n.match(Ri)||n.match(Oi)||n.match(Ti);if(s){let a=s[4],r=100/255;return[N(R4(s[1],r)+.5|0,0,255),N(R4(s[2],r)+.5|0,0,255),N(R4(s[3],r)+.5|0,0,255),a!==void 0?N(R4(a,100),0,1):1]}F2(n)}if(n.startsWith("#")){if(bi.test(n)){let s=n.substring(1),a=s.length<=4?1:2,r=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),r[l/a]=h}return r[3]=r[3]/255,r}F2(n)}let t=Hi();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&F2(n));let o=t.fillStyle;if(o.startsWith("#")||o.startsWith("rgba"))return yn(o);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);let i=Array.from(t.getImageData(0,0,1,1).data);return i[3]=r4(i[3]/255,3),i}function _n(n){return typeof n=="string"?n:q2(n)}var Ii=1024,D2={},T3=0;function Cn(n){if(n.length===4)return n;let t=n.slice();return t[3]=1,t}function b3(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function I3(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function j3(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function P3(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function D3(n){let t=j3(n[0]),e=j3(n[1]),o=j3(n[2]),i=P3(t*.222488403+e*.716873169+o*.06060791),s=500*(P3(t*.452247074+e*.399439023+o*.148375274)-i),a=200*(i-P3(t*.016863605+e*.117638439+o*.865350722)),r=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),r<0?r+360:r,n[3]]}function Ln(n){let t=(n[0]+16)/116,e=n[1],o=n[2]*Math.PI/180,i=I3(t),s=I3(t+e/500*Math.cos(o)),a=I3(t-e/200*Math.sin(o)),r=b3(s*3.021973625-i*1.617392459-a*.404875592),l=b3(s*-.943766287+i*1.916279586+a*.027607165),c=b3(s*.069407491-i*.22898585+a*1.159737864);return[N(r+.5|0,0,255),N(l+.5|0,0,255),N(c+.5|0,0,255),n[3]]}function N2(n){if(n==="none")return T4;if(D2.hasOwnProperty(n))return D2[n];if(T3>=Ii){let e=0;for(let o in D2)(e++&3)===0&&(delete D2[o],--T3)}let t=yn(n);t.length!==4&&F2(n);for(let e of t)isNaN(e)&&F2(n);return D2[n]=t,++T3,t}function E1(n){return Array.isArray(n)?n:N2(n)}function q2(n){let t=n[0];t!=(t|0)&&(t=t+.5|0);let e=n[1];e!=(e|0)&&(e=e+.5|0);let o=n[2];o!=(o|0)&&(o=o+.5|0);let i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+t+","+e+","+o+","+i+")"}function F3(n){return n[0]>0&&n[1]>0}function An(n,t,e){return e===void 0&&(e=[0,0]),e[0]=n[0]*t+.5|0,e[1]=n[1]*t+.5|0,e}function G(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}var I0=0;var r1=1<<I0++,b=1<<I0++,g1=1<<I0++,x1=1<<I0++,k0=1<<I0++,U2=1<<I0++,b4=Math.pow(2,I0)-1,U3={[r1]:"boolean",[b]:"number",[g1]:"string",[x1]:"color",[k0]:"number[]",[U2]:"size"},ji=Object.keys(U3).map(Number).sort(L0);function Pi(n){return n in U3}function G2(n){let t=[];for(let e of ji)X2(n,e)&&t.push(U3[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function X2(n,t){return(n&t)===t}function z0(n,t){return n===t}var X=class{constructor(t,e){if(!Pi(t))throw new Error(`literal expressions must have a specific type, got ${G2(t)}`);this.type=t,this.value=e}},q3=class{constructor(t,e,...o){this.type=t,this.operator=e,this.args=o}};function G3(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function e1(n,t,e){switch(typeof n){case"boolean":{if(z0(t,g1))return new X(g1,n?"true":"false");if(!X2(t,r1))throw new Error(`got a boolean, but expected ${G2(t)}`);return new X(r1,n)}case"number":{if(z0(t,U2))return new X(U2,G(n));if(z0(t,r1))return new X(r1,!!n);if(z0(t,g1))return new X(g1,n.toString());if(!X2(t,b))throw new Error(`got a number, but expected ${G2(t)}`);return new X(b,n)}case"string":{if(z0(t,x1))return new X(x1,N2(n));if(z0(t,r1))return new X(r1,!!n);if(!X2(t,g1))throw new Error(`got a string, but expected ${G2(t)}`);return new X(g1,n)}default:}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return Zi(n,t,e);for(let o of n)if(typeof o!="number")throw new Error("expected an array of numbers");if(z0(t,U2)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new X(U2,n)}if(z0(t,x1)){if(n.length===3)return new X(x1,[...n,1]);if(n.length===4)return new X(x1,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!X2(t,k0))throw new Error(`got an array of numbers, but expected ${G2(t)}`);return new X(k0,n)}var u={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},Di={[u.Get]:L(H(1,1/0),Bn),[u.Var]:L(H(1,1),Fi),[u.Has]:L(H(1,1/0),Bn),[u.Id]:L(Ni,g2),[u.Concat]:L(H(2,1/0),D(g1)),[u.GeometryType]:L(qi,g2),[u.LineMetric]:L(g2),[u.Resolution]:L(N3,g2),[u.Zoom]:L(N3,g2),[u.Time]:L(N3,g2),[u.Any]:L(H(2,1/0),D(r1)),[u.All]:L(H(2,1/0),D(r1)),[u.Not]:L(H(1,1),D(r1)),[u.Equal]:L(H(2,2),D(b4)),[u.NotEqual]:L(H(2,2),D(b4)),[u.GreaterThan]:L(H(2,2),D(b)),[u.GreaterThanOrEqualTo]:L(H(2,2),D(b)),[u.LessThan]:L(H(2,2),D(b)),[u.LessThanOrEqualTo]:L(H(2,2),D(b)),[u.Multiply]:L(H(2,1/0),Sn),[u.Coalesce]:L(H(2,1/0),Sn),[u.Divide]:L(H(2,2),D(b)),[u.Add]:L(H(2,1/0),D(b)),[u.Subtract]:L(H(2,2),D(b)),[u.Clamp]:L(H(3,3),D(b)),[u.Mod]:L(H(2,2),D(b)),[u.Pow]:L(H(2,2),D(b)),[u.Abs]:L(H(1,1),D(b)),[u.Floor]:L(H(1,1),D(b)),[u.Ceil]:L(H(1,1),D(b)),[u.Round]:L(H(1,1),D(b)),[u.Sin]:L(H(1,1),D(b)),[u.Cos]:L(H(1,1),D(b)),[u.Atan]:L(H(1,2),D(b)),[u.Sqrt]:L(H(1,1),D(b)),[u.Match]:L(H(4,1/0),En,Gi),[u.Between]:L(H(3,3),D(b)),[u.Interpolate]:L(H(6,1/0),En,Xi),[u.Case]:L(H(3,1/0),Ui,Ki),[u.In]:L(H(2,2),Yi),[u.Number]:L(H(1,1/0),D(b4)),[u.String]:L(H(1,1/0),D(b4)),[u.Array]:L(H(1,1/0),D(b)),[u.Color]:L(H(1,4),D(b)),[u.Band]:L(H(1,3),D(b)),[u.Palette]:L(H(2,2),Wi),[u.ToString]:L(H(1,1),D(r1|b|g1|x1))};function Bn(n,t,e){let o=n.length-1,i=new Array(o);for(let s=0;s<o;++s){let a=n[s+1];switch(typeof a){case"number":{i[s]=new X(b,a);break}case"string":{i[s]=new X(g1,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&e.properties.add(String(a))}return i}function Fi(n,t,e){let o=n[1];if(typeof o!="string")throw new Error("expected a string argument for var operation");return e.variables.add(o),[new X(g1,o)]}function Ni(n,t,e){e.featureId=!0}function qi(n,t,e){e.geometryType=!0}function N3(n,t,e){e.mapState=!0}function g2(n,t,e){let o=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${o} operation`);return[]}function H(n,t){return function(e,o,i){let s=e[0],a=e.length-1;if(n===t){if(a!==n){let r=n===1?"":"s";throw new Error(`expected ${n} argument${r} for ${s}, got ${a}`)}}else if(a<n||a>t){let r=t===1/0?`${n} or more`:`${n} to ${t}`;throw new Error(`expected ${r} arguments for ${s}, got ${a}`)}}}function Sn(n,t,e){let o=n.length-1,i=new Array(o);for(let s=0;s<o;++s){let a=e1(n[s+1],t,e);i[s]=a}return i}function D(n){return function(t,e,o){let i=t.length-1,s=new Array(i);for(let a=0;a<i;++a){let r=e1(t[a+1],n,o);s[a]=r}return s}}function Ui(n,t,e){let o=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${o}, got ${i} instead`)}function En(n,t,e){let o=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${o}, got ${i} instead`)}function Gi(n,t,e){let o=n.length-1,i=g1|b|r1,s=e1(n[1],i,e),a=e1(n[n.length-1],t,e),r=new Array(o-2);for(let l=0;l<o-2;l+=2){try{let c=e1(n[l+2],s.type,e);r[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{let c=e1(n[l+3],a.type,e);r[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...r,a]}function Xi(n,t,e){let o=n[1],i;switch(o[0]){case"linear":i=1;break;case"exponential":let l=o[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(o)}`)}let s=new X(b,i),a;try{a=e1(n[2],b,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}let r=new Array(n.length-3);for(let l=0;l<r.length;l+=2){try{let c=e1(n[l+3],b,e);r[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{let c=e1(n[l+4],t,e);r[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...r]}function Ki(n,t,e){let o=e1(n[n.length-1],t,e),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{let a=e1(n[s+1],r1,e);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{let a=e1(n[s+2],o.type,e);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=o,i}function Yi(n,t,e){let o=n[2];if(!Array.isArray(o))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof o[0]=="string"){if(o[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(o[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');o=o[1],i=g1}else i=b;let s=new Array(o.length);for(let r=0;r<s.length;r++)try{let l=e1(o[r],i,e);s[r]=l}catch(l){throw new Error(`failed to parse haystack item ${r} for "in" expression: ${l.message}`)}return[e1(n[1],i,e),...s]}function Wi(n,t,e){let o;try{o=e1(n[1],b,e)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}let i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");let s=new Array(i.length);for(let a=0;a<s.length;a++){let r;try{r=e1(i[a],x1,e)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(r instanceof X))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=r}return[o,...s]}function L(...n){return function(t,e,o){let i=t[0],s;for(let a=0;a<n.length;a++){let r=n[a](t,e,o);if(a==n.length-1){if(!r)throw new Error("expected last argument validator to return the parsed args");s=r}}return new q3(e,i,...s)}}function Zi(n,t,e){let o=n[0],i=Di[o];if(!i)throw new Error(`unknown operator: ${o}`);return i(n,t,e)}function X3(n){if(!n)return"";let t=n.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return X3(n.getGeometries()[0]);default:return""}}function K3(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function N1(n,t,e){let o=e1(n,t,e);return V1(o,e)}function V1(n,t){if(n instanceof X){if(n.type===x1&&typeof n.value=="string"){let o=N2(n.value);return function(){return o}}return function(){return n.value}}let e=n.operator;switch(e){case u.Number:case u.String:case u.Coalesce:return $i(n,t);case u.Get:case u.Var:case u.Has:return Ji(n,t);case u.Id:return o=>o.featureId;case u.GeometryType:return o=>o.geometryType;case u.Concat:{let o=n.args.map(i=>V1(i,t));return i=>"".concat(...o.map(s=>s(i).toString()))}case u.Resolution:return o=>o.resolution;case u.Any:case u.All:case u.Between:case u.In:case u.Not:return t5(n,t);case u.Equal:case u.NotEqual:case u.LessThan:case u.LessThanOrEqualTo:case u.GreaterThan:case u.GreaterThanOrEqualTo:return Qi(n,t);case u.Multiply:case u.Divide:case u.Add:case u.Subtract:case u.Clamp:case u.Mod:case u.Pow:case u.Abs:case u.Floor:case u.Ceil:case u.Round:case u.Sin:case u.Cos:case u.Atan:case u.Sqrt:return e5(n,t);case u.Case:return n5(n,t);case u.Match:return o5(n,t);case u.Interpolate:return i5(n,t);case u.ToString:return s5(n,t);default:throw new Error(`Unsupported operator ${e}`)}}function $i(n,t){let e=n.operator,o=n.args.length,i=new Array(o);for(let s=0;s<o;++s)i[s]=V1(n.args[s],t);switch(e){case u.Coalesce:return s=>{for(let a=0;a<o;++a){let r=i[a](s);if(typeof r<"u"&&r!==null)return r}throw new Error("Expected one of the values to be non-null")};case u.Number:case u.String:return s=>{for(let a=0;a<o;++a){let r=i[a](s);if(typeof r===e)return r}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Ji(n,t){let o=n.args[0].value;switch(n.operator){case u.Get:return i=>{let s=n.args,a=i.properties[o];for(let r=1,l=s.length;r<l;++r){let h=s[r].value;a=a[h]}return a};case u.Var:return i=>i.variables[o];case u.Has:return i=>{let s=n.args;if(!(o in i.properties))return!1;let a=i.properties[o];for(let r=1,l=s.length;r<l;++r){let h=s[r].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function Qi(n,t){let e=n.operator,o=V1(n.args[0],t),i=V1(n.args[1],t);switch(e){case u.Equal:return s=>o(s)===i(s);case u.NotEqual:return s=>o(s)!==i(s);case u.LessThan:return s=>o(s)<i(s);case u.LessThanOrEqualTo:return s=>o(s)<=i(s);case u.GreaterThan:return s=>o(s)>i(s);case u.GreaterThanOrEqualTo:return s=>o(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function t5(n,t){let e=n.operator,o=n.args.length,i=new Array(o);for(let s=0;s<o;++s)i[s]=V1(n.args[s],t);switch(e){case u.Any:return s=>{for(let a=0;a<o;++a)if(i[a](s))return!0;return!1};case u.All:return s=>{for(let a=0;a<o;++a)if(!i[a](s))return!1;return!0};case u.Between:return s=>{let a=i[0](s),r=i[1](s),l=i[2](s);return a>=r&&a<=l};case u.In:return s=>{let a=i[0](s);for(let r=1;r<o;++r)if(a===i[r](s))return!0;return!1};case u.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function e5(n,t){let e=n.operator,o=n.args.length,i=new Array(o);for(let s=0;s<o;++s)i[s]=V1(n.args[s],t);switch(e){case u.Multiply:return s=>{let a=1;for(let r=0;r<o;++r)a*=i[r](s);return a};case u.Divide:return s=>i[0](s)/i[1](s);case u.Add:return s=>{let a=0;for(let r=0;r<o;++r)a+=i[r](s);return a};case u.Subtract:return s=>i[0](s)-i[1](s);case u.Clamp:return s=>{let a=i[0](s),r=i[1](s);if(a<r)return r;let l=i[2](s);return a>l?l:a};case u.Mod:return s=>i[0](s)%i[1](s);case u.Pow:return s=>Math.pow(i[0](s),i[1](s));case u.Abs:return s=>Math.abs(i[0](s));case u.Floor:return s=>Math.floor(i[0](s));case u.Ceil:return s=>Math.ceil(i[0](s));case u.Round:return s=>Math.round(i[0](s));case u.Sin:return s=>Math.sin(i[0](s));case u.Cos:return s=>Math.cos(i[0](s));case u.Atan:return o===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case u.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function n5(n,t){let e=n.args.length,o=new Array(e);for(let i=0;i<e;++i)o[i]=V1(n.args[i],t);return i=>{for(let s=0;s<e-1;s+=2)if(o[s](i))return o[s+1](i);return o[e-1](i)}}function o5(n,t){let e=n.args.length,o=new Array(e);for(let i=0;i<e;++i)o[i]=V1(n.args[i],t);return i=>{let s=o[0](i);for(let a=1;a<e-1;a+=2)if(s===o[a](i))return o[a+1](i);return o[e-1](i)}}function i5(n,t){let e=n.args.length,o=new Array(e);for(let i=0;i<e;++i)o[i]=V1(n.args[i],t);return i=>{let s=o[0](i),a=o[1](i),r,l;for(let c=2;c<e;c+=2){let h=o[c](i),g=o[c+1](i),d=Array.isArray(g);if(d&&(g=Cn(g)),h>=a)return c===2?g:d?a5(s,a,r,l,h,g):K2(s,a,r,l,h,g);r=h,l=g}return l}}function s5(n,t){let e=n.operator,o=n.args.length,i=new Array(o);for(let s=0;s<o;++s)i[s]=V1(n.args[s],t);switch(e){case u.ToString:return s=>{let a=i[0](s);return n.args[0].type===x1?q2(a):a.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function K2(n,t,e,o,i,s){let a=i-e;if(a===0)return o;let r=t-e,l=n===1?r/a:(Math.pow(n,r)-1)/(Math.pow(n,a)-1);return o+l*(s-o)}function a5(n,t,e,o,i,s){if(i-e===0)return o;let r=D3(o),l=D3(s),c=l[2]-r[2];c>180?c-=360:c<-180&&(c+=360);let h=[K2(n,t,e,r[0],i,l[0]),K2(n,t,e,r[1],i,l[1]),r[2]+K2(n,t,e,0,i,c),K2(n,t,e,o[3],i,s[3])];return Ln(h)}var V={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Vn(n,t,e){let o=n,i=!0,s=!1,a=!1,r=[F0(o,_.LOAD,function(){a=!0,s||t()})];return o.src&&wt?(s=!0,o.decode().then(function(){i&&t()}).catch(function(l){i&&(a?t():e())})):r.push(F0(o,_.ERROR,e)),function(){i=!1,r.forEach(F)}}function r5(n,t){return new Promise((e,o)=>{function i(){a(),e(n)}function s(){a(),o(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s),t&&(n.src=t)})}function Hn(n,t){return t&&(n.src=t),n.src&&wt?new Promise((e,o)=>n.decode().then(()=>e(n)).catch(i=>n.complete&&n.width?e(n):o(i))):r5(n)}var W3=class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(let e in this.cache_){let o=this.cache_[e];(t++&3)===0&&!o.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,o){let i=Y3(t,e,o);return i in this.cache_?this.cache_[i]:null}getPattern(t,e,o){let i=Y3(t,e,o);return i in this.patternCache_?this.patternCache_[i]:null}set(t,e,o,i,s){let a=Y3(t,e,o),r=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===V.IDLE&&i.load(),i.getImageState()===V.LOADING?i.ready().then(()=>{this.patternCache_[a]=i2().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=i2().createPattern(i.getImage(1),"repeat")),r||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};function Y3(n,t,e){let o=e?E1(e):"null";return t+":"+n+":"+o}var l1=new W3;var Y2=null,I4=class extends v0{constructor(t,e,o,i,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=o,this.canvas_={},this.color_=s,this.imageState_=i===void 0?V.IDLE:i,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===V.LOADED){Y2||(Y2=K(1,1,void 0,{willReadFrequently:!0})),Y2.drawImage(this.image_,0,0);try{Y2.getImageData(0,0,1,1),this.tainted_=!1}catch{Y2=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(_.CHANGE)}handleImageError_(){this.imageState_=V.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=V.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){let t=this.size_[0],e=this.size_[1],o=K(t,e);o.fillRect(0,0,t,e),this.hitDetectionImage_=o.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===V.IDLE){this.image_||this.initializeImage_(),this.imageState_=V.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Hn(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==V.LOADED)return;let e=this.image_,o=K(Math.ceil(e.width*t),Math.ceil(e.height*t)),i=o.canvas;o.scale(t,t),o.drawImage(e,0,0),o.globalCompositeOperation="multiply",o.fillStyle=_n(this.color_),o.fillRect(0,0,i.width/t,i.height/t),o.globalCompositeOperation="destination-in",o.drawImage(e,0,0),this.canvas_[t]=i}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===V.LOADED||this.imageState_===V.ERROR)t();else{let e=()=>{(this.imageState_===V.LOADED||this.imageState_===V.ERROR)&&(this.removeEventListener(_.CHANGE,e),t())};this.addEventListener(_.CHANGE,e)}})),this.ready_}};function d2(n,t,e,o,i,s){let a=t===void 0?void 0:l1.get(t,e,i);return a||(a=new I4(n,n&&"src"in n?n.src||void 0:t,e,o,i),l1.set(t,e,i,a,s)),s&&a&&!l1.getPattern(t,e,i)&&l1.set(t,e,i,a,s),a}var On=I4;function Z3(n){return n?Array.isArray(n)?q2(n):typeof n=="object"&&"src"in n?l5(n):n:null}function l5(n){if(!n.offset||!n.size)return l1.getPattern(n.src,"anonymous",n.color);let t=n.src+":"+n.offset,e=l1.getPattern(t,void 0,n.color);if(e)return e;let o=l1.get(n.src,"anonymous",null);if(o.getImageState()!==V.LOADED)return null;let i=K(n.size[0],n.size[1]);return i.drawImage(o.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),d2(i.canvas,t,void 0,V.LOADED,n.color,!0),l1.getPattern(t,void 0,n.color)}var $3="#000",J3="round";var Q3="round",Rn=10,Tn="#000";var bn=1,In=new Q;var t6=class n{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=G(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){let t=this.getScale();return new n({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return O()}getImage(t){return O()}getHitDetectionImage(){return O()}getPixelRatio(t){return 1}getImageState(){return O()}getImageSize(){return O()}getOrigin(){return O()}getSize(){return O()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=G(t)}listenImageChange(t){O()}load(){O()}unlistenImageChange(t){O()}ready(){return Promise.resolve()}},j4=t6;var e6=class n extends j4{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?V.LOADING:V.LOADED,this.imageState_===V.LOADING&&this.ready().then(()=>this.imageState_=V.LOADED),this.render()}clone(){let t=this.getScale(),e=new n({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){let t=this.size_,e=this.getDisplacement(),o=this.getScaleArray();return[t[0]/2-e[0]/o[0],t[1]/2+e[1]/o[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.fill_?.getKey(),o=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(","),i=l1.get(o,null,null)?.getImage(1);if(!i){let s=this.renderOptions_,a=Math.ceil(s.size*t),r=K(a,a);this.draw_(s,r,t),i=r.canvas,l1.set(o,null,null,new On(i,void 0,null,V.LOADED,null))}return i}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,o){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){let A=i;i=s,s=A}let a=this.radius2_===void 0?this.points_:this.points_*2,r=2*Math.PI/a,l=s*Math.sin(r),c=Math.sqrt(s*s-l*l),h=i-c,g=Math.sqrt(l*l+h*h),d=g/l;if(t==="miter"&&d<=o)return d*e;let w=e/2/d,v=e/2*(h/g),p=Math.sqrt((i+w)*(i+w)+v*v)-i;if(this.radius2_===void 0||t==="bevel")return p*2;let x=i*Math.sin(r),M=Math.sqrt(i*i-x*x),k=s-M,f=Math.sqrt(x*x+k*k)/x;if(f<=o){let A=f*e/2-s-i;return 2*Math.max(p,A)}return p*2}createRenderOptions(){let t=J3,e=Q3,o=0,i=null,s=0,a,r=0;this.stroke_&&(a=Z3(this.stroke_.getColor()??Tn),r=this.stroke_.getWidth()??bn,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Q3,t=this.stroke_.getLineCap()??J3,o=this.stroke_.getMiterLimit()??Rn);let l=this.calculateLineJoinSize_(e,r,o),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:r,size:h,lineCap:t,lineDash:i,lineDashOffset:s,lineJoin:e,miterLimit:o}}render(){this.renderOptions_=this.createRenderOptions();let t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,o){if(e.scale(o,o),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let i=this.fill_.getColor();i===null&&(i=$3),e.fillStyle=Z3(i),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let o=this.fill_.getColor(),i=0;typeof o=="string"&&(o=E1(o)),o===null?i=1:Array.isArray(o)&&(i=o.length===4?o[3]:1),i===0&&(e=K(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_,o=this.radius;if(e===1/0)t.arc(0,0,o,0,2*Math.PI);else{let i=this.radius2_===void 0?o:this.radius2_;this.radius2_!==void 0&&(e*=2);let s=this.angle_-Math.PI/2,a=2*Math.PI/e;for(let r=0;r<e;r++){let l=s+r*a,c=r%2===0?o:i;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=$3,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}},P4=e6;var n6=class n extends P4{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){let t=this.getScale(),e=new n({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}},D4=n6;var o6=class n{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){let t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){let e=d2(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===V.IDLE&&e.load(),e.getImageState()===V.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){let t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?q(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:E1(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}},v2=o6;function jn(n,t,e,o){return e!==void 0&&o!==void 0?[e/n,o/t]:e!==void 0?e/n:o!==void 0?o/t:1}var i6=class n extends j4{constructor(t){t=t||{};let e=t.opacity!==void 0?t.opacity:1,o=t.rotation!==void 0?t.rotation:0,i=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:o,scale:i,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;let a=t.img!==void 0?t.img:null,r=t.src;T(!(r!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(r===void 0||r.length===0)&&a&&(r=a.src||q(a)),T(r!==void 0&&r.length>0,"A defined and non-empty `src` or `image` must be provided"),T(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=V.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?V.LOADED:V.IDLE:l=V.LOADING:l=V.LOADED),this.color_=t.color!==void 0?E1(t.color):null,this.iconImage_=d2(a,r,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,h;if(t.size)[c,h]=t.size;else{let g=this.getImage(1);if(g.width&&g.height)c=g.width,h=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=t;let d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;let w=this.iconImage_.getSize();this.setScale(jn(w[0],w[1],t.width,t.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(jn(c,h,t.width,t.height))}}clone(){let t,e,o;return this.initialOptions_?(e=this.initialOptions_.width,o=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new n({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:o,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;let i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=i[0]),this.anchorYUnits_=="fraction"&&(t[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+i[1])}this.normalizedAnchor_=t}let e=this.getDisplacement(),o=this.getScaleArray();return[t[0]-e[0]/o[0],t[1]+e[1]/o[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){let e=this.getSize(),o=this.iconImage_.getSize();if(!e||!o)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=o[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=o[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){let t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==V.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){let t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==V.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(_.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(_.CHANGE,t)}ready(){return this.iconImage_.ready()}},Pn=i6;var s6=class n{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){let t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}},F4=s6;var N4=class n{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Dn,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new n({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Dn,this.geometry_=t}setZIndex(t){this.zIndex_=t}};function Fn(n){let t;if(typeof n=="function")t=n;else{let e;Array.isArray(n)?e=n:(T(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[n]),t=function(){return e}}return t}var a6=null;function r6(n,t){if(!a6){let e=new v2({color:"rgba(255,255,255,0.4)"}),o=new F4({color:"#3399CC",width:1.25});a6=[new N4({image:new D4({fill:e,stroke:o,radius:5}),fill:e,stroke:o})]}return a6}function Dn(n){return n.getGeometry()}var w2=N4;var c5="#333",l6=class n{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=G(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new v2({color:c5}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){let t=this.getScale();return new n({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=G(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}},Nn=l6;function h5(n){return!0}function Xn(n){let t=G3(),e=g5(n,t),o=K3();return function(i,s){if(o.properties=i.getPropertiesInternal(),o.resolution=s,t.featureId){let a=i.getId();a!==void 0?o.featureId=a:o.featureId=null}return t.geometryType&&(o.geometryType=X3(i.getGeometry())),e(o)}}function g6(n){let t=G3(),e=n.length,o=new Array(e);for(let a=0;a<e;++a)o[a]=c6(n[a],t);let i=K3(),s=new Array(e);return function(a,r){if(i.properties=a.getPropertiesInternal(),i.resolution=r,t.featureId){let c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<e;++c){let h=o[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function g5(n,t){let e=n.length,o=new Array(e);for(let i=0;i<e;++i){let s=n[i],a="filter"in s?N1(s.filter,r1,t):h5,r;if(Array.isArray(s.style)){let l=s.style.length;r=new Array(l);for(let c=0;c<l;++c)r[c]=c6(s.style[c],t)}else r=[c6(s.style,t)];o[i]={filter:a,styles:r}}return function(i){let s=[],a=!1;for(let r=0;r<e;++r){let l=o[r].filter;if(l(i)&&!(n[r].else&&a)){a=!0;for(let c of o[r].styles){let h=c(i);h&&s.push(h)}}}return s}}function c6(n,t){let e=W2(n,"",t),o=Z2(n,"",t),i=d5(n,t),s=v5(n,t),a=p1(n,"z-index",t);if(!e&&!o&&!i&&!s&&!n4(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));let r=new w2;return function(l){let c=!0;if(e){let h=e(l);h&&(c=!1),r.setFill(h)}if(o){let h=o(l);h&&(c=!1),r.setStroke(h)}if(i){let h=i(l);h&&(c=!1),r.setText(h)}if(s){let h=s(l);h&&(c=!1),r.setImage(h)}return a&&r.setZIndex(a(l)),c?null:r}}function W2(n,t,e){let o;if(t+"fill-pattern-src"in n)o=m5(n,t+"fill-",e);else{if(n[t+"fill-color"]==="none")return s=>null;o=d6(n,t+"fill-color",e)}if(!o)return null;let i=new v2;return function(s){let a=o(s);return a===T4?null:(i.setColor(a),i)}}function Z2(n,t,e){let o=p1(n,t+"stroke-width",e),i=d6(n,t+"stroke-color",e);if(!o&&!i)return null;let s=o0(n,t+"stroke-line-cap",e),a=o0(n,t+"stroke-line-join",e),r=Kn(n,t+"stroke-line-dash",e),l=p1(n,t+"stroke-line-dash-offset",e),c=p1(n,t+"stroke-miter-limit",e),h=new F4;return function(g){if(i){let d=i(g);if(d===T4)return null;h.setColor(d)}if(o&&h.setWidth(o(g)),s){let d=s(g);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(d)}if(a){let d=a(g);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(d)}return r&&h.setLineDash(r(g)),l&&h.setLineDashOffset(l(g)),c&&h.setMiterLimit(c(g)),h}}function d5(n,t){let e="text-",o=o0(n,e+"value",t);if(!o)return null;let i=W2(n,e,t),s=W2(n,e+"background-",t),a=Z2(n,e,t),r=Z2(n,e+"background-",t),l=o0(n,e+"font",t),c=p1(n,e+"max-angle",t),h=p1(n,e+"offset-x",t),g=p1(n,e+"offset-y",t),d=u2(n,e+"overflow",t),w=o0(n,e+"placement",t),v=p1(n,e+"repeat",t),m=G4(n,e+"scale",t),p=u2(n,e+"rotate-with-view",t),x=p1(n,e+"rotation",t),M=o0(n,e+"align",t),k=o0(n,e+"justify",t),z=o0(n,e+"baseline",t),f=u2(n,e+"keep-upright",t),A=Kn(n,e+"padding",t),B=X4(n,e+"declutter-mode"),C=new Nn({declutterMode:B});return function(S){if(C.setText(o(S)),i&&C.setFill(i(S)),s&&C.setBackgroundFill(s(S)),a&&C.setStroke(a(S)),r&&C.setBackgroundStroke(r(S)),l&&C.setFont(l(S)),c&&C.setMaxAngle(c(S)),h&&C.setOffsetX(h(S)),g&&C.setOffsetY(g(S)),d&&C.setOverflow(d(S)),w){let E=w(S);if(E!=="point"&&E!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(E)}if(v&&C.setRepeat(v(S)),m&&C.setScale(m(S)),p&&C.setRotateWithView(p(S)),x&&C.setRotation(x(S)),M){let E=M(S);if(E!=="left"&&E!=="center"&&E!=="right"&&E!=="end"&&E!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(E)}if(k){let E=k(S);if(E!=="left"&&E!=="right"&&E!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(E)}if(z){let E=z(S);if(E!=="bottom"&&E!=="top"&&E!=="middle"&&E!=="alphabetic"&&E!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(E)}return A&&C.setPadding(A(S)),f&&C.setKeepUpright(f(S)),C}}function v5(n,t){return"icon-src"in n?w5(n,t):"shape-points"in n?u5(n,t):"circle-radius"in n?p5(n,t):null}function w5(n,t){let e="icon-",o=e+"src",i=Yn(n[o],o),s=q4(n,e+"anchor",t),a=G4(n,e+"scale",t),r=p1(n,e+"opacity",t),l=q4(n,e+"displacement",t),c=p1(n,e+"rotation",t),h=u2(n,e+"rotate-with-view",t),g=Un(n,e+"anchor-origin"),d=Gn(n,e+"anchor-x-units"),w=Gn(n,e+"anchor-y-units"),v=z5(n,e+"color"),m=f5(n,e+"cross-origin"),p=M5(n,e+"offset"),x=Un(n,e+"offset-origin"),M=U4(n,e+"width"),k=U4(n,e+"height"),z=x5(n,e+"size"),f=X4(n,e+"declutter-mode"),A=new Pn({src:i,anchorOrigin:g,anchorXUnits:d,anchorYUnits:w,color:v,crossOrigin:m,offset:p,offsetOrigin:x,height:k,width:M,size:z,declutterMode:f});return function(B){return r&&A.setOpacity(r(B)),l&&A.setDisplacement(l(B)),c&&A.setRotation(c(B)),h&&A.setRotateWithView(h(B)),a&&A.setScale(a(B)),s&&A.setAnchor(s(B)),A}}function u5(n,t){let e="shape-",o=e+"points",i=e+"radius",s=h6(n[o],o),a=h6(n[i],i),r=W2(n,e,t),l=Z2(n,e,t),c=G4(n,e+"scale",t),h=q4(n,e+"displacement",t),g=p1(n,e+"rotation",t),d=u2(n,e+"rotate-with-view",t),w=U4(n,e+"radius2"),v=U4(n,e+"angle"),m=X4(n,e+"declutter-mode"),p=new P4({points:s,radius:a,radius2:w,angle:v,declutterMode:m});return function(x){return r&&p.setFill(r(x)),l&&p.setStroke(l(x)),h&&p.setDisplacement(h(x)),g&&p.setRotation(g(x)),d&&p.setRotateWithView(d(x)),c&&p.setScale(c(x)),p}}function p5(n,t){let e="circle-",o=W2(n,e,t),i=Z2(n,e,t),s=p1(n,e+"radius",t),a=G4(n,e+"scale",t),r=q4(n,e+"displacement",t),l=p1(n,e+"rotation",t),c=u2(n,e+"rotate-with-view",t),h=X4(n,e+"declutter-mode"),g=new D4({radius:5,declutterMode:h});return function(d){return s&&g.setRadius(s(d)),o&&g.setFill(o(d)),i&&g.setStroke(i(d)),r&&g.setDisplacement(r(d)),l&&g.setRotation(l(d)),c&&g.setRotateWithView(c(d)),a&&g.setScale(a(d)),g}}function p1(n,t,e){if(!(t in n))return;let o=N1(n[t],b,e);return function(i){return h6(o(i),t)}}function o0(n,t,e){if(!(t in n))return null;let o=N1(n[t],g1,e);return function(i){return Yn(o(i),t)}}function m5(n,t,e){let o=o0(n,t+"pattern-src",e),i=qn(n,t+"pattern-offset",e),s=qn(n,t+"pattern-size",e),a=d6(n,t+"color",e);return function(r){return{src:o(r),offset:i&&i(r),size:s&&s(r),color:a&&a(r)}}}function u2(n,t,e){if(!(t in n))return null;let o=N1(n[t],r1,e);return function(i){let s=o(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function d6(n,t,e){if(!(t in n))return null;let o=N1(n[t],x1,e);return function(i){return Wn(o(i),t)}}function Kn(n,t,e){if(!(t in n))return null;let o=N1(n[t],k0,e);return function(i){return $2(o(i),t)}}function q4(n,t,e){if(!(t in n))return null;let o=N1(n[t],k0,e);return function(i){let s=$2(o(i),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function qn(n,t,e){if(!(t in n))return null;let o=N1(n[t],k0,e);return function(i){return Zn(o(i),t)}}function G4(n,t,e){if(!(t in n))return null;let o=N1(n[t],k0|b,e);return function(i){return k5(o(i),t)}}function U4(n,t){let e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function x5(n,t){let e=n[t];if(e!==void 0){if(typeof e=="number")return G(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function f5(n,t){let e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function Un(n,t){let e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function Gn(n,t){let e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function M5(n,t){let e=n[t];if(e!==void 0)return $2(e,t)}function X4(n,t){let e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function z5(n,t){let e=n[t];if(e!==void 0)return Wn(e,t)}function $2(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);let e=n.length;for(let o=0;o<e;++o)if(typeof n[o]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function Yn(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function h6(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function Wn(n,t){if(typeof n=="string")return n;let e=$2(n,t),o=e.length;if(o<3||o>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function Zn(n,t){let e=$2(n,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function k5(n,t){return typeof n=="number"?n:Zn(n,t)}var $n={RENDER_ORDER:"renderOrder"},v6=class extends b0{constructor(t){t=t||{};let e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get($n.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){let o=this.getDeclutter();o in t.declutter||(t.declutter[o]=new O4(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set($n.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?r6:t;let e=y5(t);this.styleFunction_=t===null?void 0:Fn(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}};function y5(n){if(n===void 0)return r6;if(!n)return null;if(typeof n=="function"||n instanceof w2)return n;if(!Array.isArray(n))return g6([n]);if(n.length===0)return[];let t=n.length,e=n[0];if(e instanceof w2){let i=new Array(t);for(let s=0;s<t;++s){let a=n[s];if(!(a instanceof w2))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in e){let i=new Array(t);for(let s=0;s<t;++s){let a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return Xn(i)}return g6(n)}var Jn=v6;var w6=class extends a1{constructor(t,e,o,i){super(t),this.inversePixelTransform=e,this.frameState=o,this.context=i}},K4=w6;var u6=class extends h0{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){O()}calculateMatrices2D(t){let e=t.viewState,o=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;n0(o,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),M4(i,o)}forEachFeatureAtCoordinate(t,e,o,i,s,a,r,l){let c,h=e.viewState;function g(z,f,A,B){return s.call(a,f,z?A:null,B)}let d=h.projection,w=Ge(t.slice(),d),v=[[0,0]];if(d.canWrapX()&&i){let z=d.getExtent(),f=I(z);v.push([-f,0],[f,0])}let m=e.layerStatesArray,p=m.length,x=[],M=[];for(let z=0;z<v.length;z++)for(let f=p-1;f>=0;--f){let A=m[f],B=A.layer;if(B.hasRenderer()&&b2(A,h)&&r.call(l,B)){let C=B.getRenderer(),S=B.getSource();if(C&&S){let E=S.getWrapX()?w:t,Z=g.bind(null,A.managed);M[0]=E[0]+v[z][0],M[1]=E[1]+v[z][1],c=C.forEachFeatureAtCoordinate(M,e,o,Z,x)}if(c)return c}}if(x.length===0)return;let k=1/x.length;return x.forEach((z,f)=>z.distanceSq+=f*k),x.sort((z,f)=>z.distanceSq-f.distanceSq),x.some(z=>c=z.callback(z.feature,z.layer,z.geometry)),c}hasFeatureAtCoordinate(t,e,o,i,s,a){return this.forEachFeatureAtCoordinate(t,e,o,i,A0,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(t){O()}scheduleExpireIconCache(t){l1.canExpireCache()&&t.postRenderFunctions.push(_5)}};function _5(n,t){l1.expire()}var Qn=u6;var p6=class extends Qn{constructor(t){super(t),this.fontChangeListenerKey_=R(In,X1.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");let e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=f0+" ol-layers";let o=t.getViewport();o.insertBefore(this.element_,o.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){let o=this.getMap();if(o.hasListener(t)){let i=new K4(t,void 0,e);o.dispatchEvent(i)}}disposeInternal(){F(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(u1.PRECOMPOSE,t);let e=t.layerStatesArray.sort((r,l)=>r.zIndex-l.zIndex);e.some(r=>r.layer instanceof Jn&&r.layer.getDeclutter())&&(t.declutter={});let i=t.viewState;this.children_.length=0;let s=[],a=null;for(let r=0,l=e.length;r<l;++r){let c=e[r];t.layerIndex=r;let h=c.layer,g=h.getSourceState();if(!b2(c,i)||g!="ready"&&g!="undefined"){h.unrender();continue}let d=h.render(t,a);d&&(d!==a&&(this.children_.push(d),a=d),s.push(c))}this.declutter(t,s),$8(this.element_,this.children_),this.dispatchRenderEvent(u1.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let o=e.length-1;o>=0;--o){let i=e[o],s=i.layer;s.getDeclutter()&&s.renderDeclutter(t,i)}e.forEach(o=>o.layer.renderDeferred(t))}}},to=p6;function eo(n){if(n instanceof b0){n.setMapInternal(null);return}n instanceof T2&&n.getLayers().forEach(eo)}function no(n,t){if(n instanceof b0){n.setMapInternal(t);return}if(n instanceof T2){let e=n.getLayers().getArray();for(let o=0,i=e.length;o<i;++o)no(e[o],t)}}var m6=class extends Q{constructor(t){super(),t=t||{},this.on,this.once,this.un;let e=C5(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:ye,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=e0(),this.pixelToCoordinateTransform_=e0(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||en(),this.interactions=e.interactions||zn({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Ae(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(o1.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(o1.VIEW,this.handleViewChanged_),this.addChangeListener(o1.SIZE,this.handleSizeChanged_),this.addChangeListener(o1.TARGET,this.handleTargetChanged_),this.setProperties(e.values);let o=this;t.view&&!(t.view instanceof w1)&&t.view.then(function(i){o.setView(new w1(i))}),this.controls.addEventListener(h1.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(h1.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(h1.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(h1.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(h1.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(h1.REMOVE,i=>{let s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){no(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){let e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,o){if(!this.frameState_||!this.renderer_)return;let i=this.getCoordinateFromPixelInternal(t);o=o!==void 0?o:{};let s=o.hitTolerance!==void 0?o.hitTolerance:0,a=o.layerFilter!==void 0?o.layerFilter:A0,r=o.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,r,e,null,a,null)}getFeaturesAtPixel(t,e){let o=[];return this.forEachFeatureAtPixel(t,function(i){o.push(i)},e),o}getAllLayers(){let t=[];function e(o){o.forEach(function(i){i instanceof T2?e(i.getLayers()):t.push(i)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;let o=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};let i=e.layerFilter!==void 0?e.layerFilter:A0,s=e.hitTolerance!==void 0?e.hitTolerance:0,a=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(o,this.frameState_,s,a,i,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){let o=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=o.width/i[0],a=o.height/i[1],r="changedTouches"in t?t.changedTouches[0]:t;return[(r.clientX-o.left)/s,(r.clientY-o.top)/a]}getTarget(){return this.get(o1.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return V2(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){let e=this.frameState_;return e?s1(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){let e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(o1.LAYERGROUP)}setLayers(t){let e=this.getLayerGroup();if(t instanceof m1){e.setLayers(t);return}let o=e.getLayers();o.clear(),o.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){let t=this.getLayerGroup().getLayerStatesArray();for(let e=0,o=t.length;e<o;++e){let i=t[e];if(!i.visible)continue;let s=i.layer.getRenderer();if(s&&!s.ready)return!0;let a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(t){let e=B1(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){let e=this.frameState_;return e?s1(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(o1.SIZE)}getView(){return this.get(o1.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){let t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,o,i){return Be(this.frameState_,t,e,o,i)}handleBrowserEvent(t,e){e=e||t.type;let o=new b1(e,this,t);this.handleMapBrowserEvent(o)}handleMapBrowserEvent(t){if(!this.frameState_)return;let e=t.originalEvent,o=e.type;if(o===k2.POINTERDOWN||o===_.WHEEL||o===_.KEYDOWN){let i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=e.target,r=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!r.contains(a))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){let i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){let a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){let t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,s=i;if(t){let a=t.viewHints;if(a[v1.ANIMATING]||a[v1.INTERACTING]){let r=Date.now()-t.time>8;i=r?0:8,s=r?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(u1.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(u1.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new w0(I1.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new w0(I1.LOADSTART,this,t))));let o=this.postRenderFunctions_;if(t)for(let i=0,s=o.length;i<s;++i)o[i](this,t);o.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let o=0,i=this.targetChangeHandlerKeys_.length;o<i;++o)F(this.targetChangeHandlerKeys_[o]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(_.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);let o=this.targetElement_.getRootNode();o instanceof ShadowRoot&&this.resizeObserver_.unobserve(o.host),this.setSize(void 0)}let t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new to(this)),this.mapBrowserEventHandler_=new Ce(this,this.moveTolerance_);for(let s in U)this.mapBrowserEventHandler_.addEventListener(U[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(_.WHEEL,this.boundHandleBrowserEvent_,s4?{passive:!1}:!1);let o;if(this.keyboardEventTarget_)o=this.keyboardEventTarget_;else{let s=e.getRootNode();o=s instanceof ShadowRoot?s.host:e}this.targetChangeHandlerKeys_=[R(o,_.KEYDOWN,this.handleBrowserEvent,this),R(o,_.KEYPRESS,this.handleBrowserEvent,this)];let i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(F(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(F(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);let t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=R(t,X1.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=R(t,_.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(F),this.layerGroupPropertyListenerKeys_=null);let t=this.getLayerGroup();t&&(this.handleLayerAdd_(new S1("addlayer",t)),this.layerGroupPropertyListenerKeys_=[R(t,X1.PROPERTYCHANGE,this.render,this),R(t,_.CHANGE,this.render,this),R(t,"addlayer",this.handleLayerAdd_,this),R(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;let t=this.frameState_.layerStatesArray;for(let e=0,o=t.length;e<o;++e){let i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){eo(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){let e=this.getSize(),o=this.getView(),i=this.frameState_,s=null;if(e!==void 0&&F3(e)&&o&&o.isDef()){let a=o.getHints(this.frameState_?this.frameState_.viewHints:void 0),r=o.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:S2(r.center,r.resolution,r.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:r,viewHints:a,wantedTiles:{},mapId:q(this),renderTargets:{}},r.nextCenter&&r.nextResolution){let l=isNaN(r.nextRotation)?r.rotation:r.nextRotation;s.nextExtent=S2(r.nextCenter,r.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!p0(this.previousExtent_)&&!L2(s.extent,this.previousExtent_))&&(this.dispatchEvent(new w0(I1.MOVESTART,this,i)),this.previousExtent_=E0(this.previousExtent_)),this.previousExtent_&&!s.viewHints[v1.ANIMATING]&&!s.viewHints[v1.INTERACTING]&&!L2(s.extent,this.previousExtent_)&&(this.dispatchEvent(new w0(I1.MOVEEND,this,s)),Re(s.extent,this.previousExtent_))),this.dispatchEvent(new w0(I1.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(I1.LOADSTART)||this.hasListener(I1.LOADEND)||this.hasListener(u1.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){let e=this.getLayerGroup();e&&this.handleLayerRemove_(new S1("removelayer",e)),this.set(o1.LAYERGROUP,t)}setSize(t){this.set(o1.SIZE,t)}setTarget(t){this.set(o1.TARGET,t)}setView(t){if(!t||t instanceof w1){this.set(o1.VIEW,t);return}this.set(o1.VIEW,new w1);let e=this;t.then(function(o){e.setView(new w1(o))})}updateSize(){let t=this.getTargetElement(),e;if(t){let i=getComputedStyle(t),s=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),a=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(s)&&!isNaN(a)&&(e=[Math.max(0,s),Math.max(0,a)],!F3(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&g4("No map visible because the map container's width or height are 0."))}let o=this.getSize();e&&(!o||!g0(e,o))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){let e=this.getView();e&&e.setViewportSize(t)}};function C5(n){let t=null;n.keyboardEventTarget!==void 0&&(t=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);let e={},o=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new T2({layers:n.layers});e[o1.LAYERGROUP]=o,e[o1.TARGET]=n.target,e[o1.VIEW]=n.view instanceof w1?n.view:new w1;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new m1(n.controls.slice()):(T(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new m1(n.interactions.slice()):(T(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new m1(n.overlays.slice()):(T(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new m1,{controls:i,interactions:s,keyboardEventTarget:t,overlays:a,values:e}}var x6=m6;var f6=class extends v0{constructor(t,e,o){super(),o=o||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=o.transition===void 0?250:o.transition,this.transitionStarts_={},this.interpolate=!!o.interpolate}changed(){this.dispatchEvent(_.CHANGE)}release(){this.setState(y.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==y.EMPTY){if(this.state!==y.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){O()}getAlpha(t,e){if(!this.transition_)return 1;let o=this.transitionStarts_[t];if(!o)o=e,this.transitionStarts_[t]=o;else if(o===-1)return 1;let i=e-o+1e3/60;return i>=this.transition_?1:yt(i/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},p2=f6;function Y4(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}var L5=new Error("disposed");var A5=[256,256],M6=class extends p2{constructor(t){let e=y.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;let t=Y4(this.data_);return t?[t.width,t.height]:A5}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==y.IDLE&&this.state!==y.ERROR)return;this.state=y.LOADING,this.changed();let t=this;this.loader_().then(function(e){t.data_=e,t.state=y.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=y.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(L5),this.controller_=null),super.disposeInternal()}},z6=M6;var k6=class extends p2{constructor(t,e,o,i,s,a){super(t,e,a),this.crossOrigin_=i,this.src_=o,this.key=o,this.image_=new Image,i!==null&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=y.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=y.ERROR,this.unlistenImage_(),this.image_=B5(),this.changed()}handleImageLoad_(){let t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=y.LOADED:this.state=y.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==y.ERROR&&(this.state=y.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==y.IDLE&&(this.state=y.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Vn(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};function B5(){let n=K(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}var W4=k6;var Z4=class{constructor(t,e,o,i){this.minX=t,this.maxX=e,this.minY=o,this.maxY=i}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}};function j0(n,t,e,o,i){return i!==void 0?(i.minX=n,i.maxX=t,i.minY=e,i.maxY=o,i):new Z4(n,t,e,o)}var $4=Z4;var y6,P0=[];function oo(n,t,e,o,i){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(o,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,o)+1,Math.max(e,i)),n.restore()}function _6(n,t){return Math.abs(n[t*4]-210)>2||Math.abs(n[t*4+3]-.75*255)>2}function S5(){if(y6===void 0){let n=K(6,6,P0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",oo(n,4,5,4,0),oo(n,4,5,0,5);let t=n.getImageData(0,0,3,3).data;y6=_6(t,0)||_6(t,4)||_6(t,8),O2(n),P0.push(n.canvas)}return y6}function io(n,t,e,o){let i=R0(e,t,n),s=bt(t,o,e),a=t.getMetersPerUnit();a!==void 0&&(s*=a);let r=n.getMetersPerUnit();r!==void 0&&(s/=r);let l=n.getExtent();if(!l||U0(l,i)){let c=bt(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function so(n,t,e,o){let i=j1(e),s=io(n,t,i,o);return(!isFinite(s)||s<=0)&&h4(e,function(a){return s=io(n,t,a,o),isFinite(s)&&s>0}),s}function ao(n,t,e,o,i,s,a,r,l,c,h,g,d,w){let v=K(Math.round(e*n),Math.round(e*t),P0);if(g||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(e,e);function m(f){return Math.round(f*e)/e}v.globalCompositeOperation="lighter";let p=k1();l.forEach(function(f,A,B){Ie(p,f.extent)});let x,M=e/o,k=(g?1:1+Math.pow(2,-24))/M;if(!d||l.length!==1||c!==0){if(x=K(Math.round(I(p)*M),Math.round(J(p)*M),P0),g||(x.imageSmoothingEnabled=!1),i&&w){let f=(i[0]-p[0])*M,A=-(i[3]-p[3])*M,B=I(i)*M,C=J(i)*M;x.rect(f,A,B,C),x.clip()}l.forEach(function(f,A,B){if(f.image.width>0&&f.image.height>0){if(f.clipExtent){x.save();let $=(f.clipExtent[0]-p[0])*M,j=-(f.clipExtent[3]-p[3])*M,c1=I(f.clipExtent)*M,n1=J(f.clipExtent)*M;x.rect(g?$:Math.round($),g?j:Math.round(j),g?c1:Math.round($+c1)-Math.round($),g?n1:Math.round(j+n1)-Math.round(j)),x.clip()}let C=(f.extent[0]-p[0])*M,S=-(f.extent[3]-p[3])*M,E=I(f.extent)*M,Z=J(f.extent)*M;x.drawImage(f.image,c,c,f.image.width-2*c,f.image.height-2*c,g?C:Math.round(C),g?S:Math.round(S),g?E:Math.round(C+E)-Math.round(C),g?Z:Math.round(S+Z)-Math.round(S)),f.clipExtent&&x.restore()}})}let z=y1(a);return r.getTriangles().forEach(function(f,A,B){let C=f.source,S=f.target,E=C[0][0],Z=C[0][1],$=C[1][0],j=C[1][1],c1=C[2][0],n1=C[2][1],q1=m((S[0][0]-z[0])/s),i0=m(-(S[0][1]-z[1])/s),Y=m((S[1][0]-z[0])/s),W=m(-(S[1][1]-z[1])/s),f1=m((S[2][0]-z[0])/s),_0=m(-(S[2][1]-z[1])/s),H1=E,O1=Z;E=0,Z=0,$-=H1,j-=O1,c1-=H1,n1-=O1;let U1=[[$,j,0,0,Y-q1],[c1,n1,0,0,f1-q1],[0,0,$,j,W-i0],[0,0,c1,n1,_0-i0]],R1=Ee(U1);if(!R1)return;if(v.save(),v.beginPath(),S5()||!g){v.moveTo(Y,W);let d1=4,C0=q1-Y,a0=i0-W;for(let T1=0;T1<d1;T1++)v.lineTo(Y+m((T1+1)*C0/d1),W+m(T1*a0/(d1-1))),T1!=d1-1&&v.lineTo(Y+m((T1+1)*C0/d1),W+m((T1+1)*a0/(d1-1)));v.lineTo(f1,_0)}else v.moveTo(Y,W),v.lineTo(q1,i0),v.lineTo(f1,_0);v.clip(),v.transform(R1[0],R1[2],R1[1],R1[3],q1,i0),v.translate(p[0]-H1,p[3]-O1);let s0;if(x)s0=x.canvas,v.scale(k,-k);else{let d1=l[0],C0=d1.extent;s0=d1.image,v.scale(I(C0)/s0.width,-J(C0)/s0.height)}v.drawImage(s0,0,0),v.restore()}),x&&(O2(x),P0.push(x.canvas)),h&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,r.getTriangles().forEach(function(f,A,B){let C=f.target,S=(C[0][0]-z[0])/s,E=-(C[0][1]-z[1])/s,Z=(C[1][0]-z[0])/s,$=-(C[1][1]-z[1])/s,j=(C[2][0]-z[0])/s,c1=-(C[2][1]-z[1])/s;v.beginPath(),v.moveTo(Z,$),v.lineTo(S,E),v.lineTo(j,c1),v.closePath(),v.stroke()}),v.restore()),v.canvas}var E5=10,ro=.25,C6=class{constructor(t,e,o,i,s,a,r){this.sourceProj_=t,this.targetProj_=e;let l={},c=r?v8(k=>s1(r,R0(k,this.targetProj_,this.sourceProj_))):O0(this.targetProj_,this.sourceProj_);this.transformInv_=function(k){let z=k[0]+"/"+k[1];return l[z]||(l[z]=c(k)),l[z]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&I(i)>=I(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?I(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?I(this.targetProj_.getExtent()):null;let h=y1(o),g=K0(o),d=X0(o),w=G0(o),v=this.transformInv_(h),m=this.transformInv_(g),p=this.transformInv_(d),x=this.transformInv_(w),M=E5+(a?Math.max(0,Math.ceil(Math.log2(B2(o)/(a*a*256*256)))):0);if(this.addQuad_(h,g,d,w,v,m,p,x,M),this.wrapsXInSource_){let k=1/0;this.triangles_.forEach(function(z,f,A){k=Math.min(k,z.source[0][0],z.source[1][0],z.source[2][0])}),this.triangles_.forEach(z=>{if(Math.max(z.source[0][0],z.source[1][0],z.source[2][0])-k>this.sourceWorldWidth_/2){let f=[[z.source[0][0],z.source[0][1]],[z.source[1][0],z.source[1][1]],[z.source[2][0],z.source[2][1]]];f[0][0]-k>this.sourceWorldWidth_/2&&(f[0][0]-=this.sourceWorldWidth_),f[1][0]-k>this.sourceWorldWidth_/2&&(f[1][0]-=this.sourceWorldWidth_),f[2][0]-k>this.sourceWorldWidth_/2&&(f[2][0]-=this.sourceWorldWidth_);let A=Math.min(f[0][0],f[1][0],f[2][0]);Math.max(f[0][0],f[1][0],f[2][0])-A<this.sourceWorldWidth_/2&&(z.source=f)}})}l={}}addTriangle_(t,e,o,i,s,a){this.triangles_.push({source:[i,s,a],target:[t,e,o]})}addQuad_(t,e,o,i,s,a,r,l,c){let h=ft([s,a,r,l]),g=this.sourceWorldWidth_?I(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,w=this.sourceProj_.canWrapX()&&g>.5&&g<1,v=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){let p=ft([t,e,o,i]);v=I(p)/this.targetWorldWidth_>ro||v}!w&&this.sourceProj_.isGlobal()&&g&&(v=g>ro||v)}if(!v&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Z1(h,this.maxSourceExtent_))return;let m=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(r[0])||!isFinite(r[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)v=!0;else if(m=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(r[0])||!isFinite(r[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(c>0){if(!v){let p=[(t[0]+o[0])/2,(t[1]+o[1])/2],x=this.transformInv_(p),M;w?M=(W1(s[0],d)+W1(r[0],d))/2-W1(x[0],d):M=(s[0]+r[0])/2-x[0];let k=(s[1]+r[1])/2-x[1];v=M*M+k*k>this.errorThresholdSquared_}if(v){if(Math.abs(t[0]-o[0])<=Math.abs(t[1]-o[1])){let p=[(e[0]+o[0])/2,(e[1]+o[1])/2],x=this.transformInv_(p),M=[(i[0]+t[0])/2,(i[1]+t[1])/2],k=this.transformInv_(M);this.addQuad_(t,e,p,M,s,a,x,k,c-1),this.addQuad_(M,p,o,i,k,x,r,l,c-1)}else{let p=[(t[0]+e[0])/2,(t[1]+e[1])/2],x=this.transformInv_(p),M=[(o[0]+i[0])/2,(o[1]+i[1])/2],k=this.transformInv_(M);this.addQuad_(t,p,M,i,s,x,k,l,c-1),this.addQuad_(p,e,o,M,x,a,r,k,c-1)}return}}if(w){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(m&11)==0&&this.addTriangle_(t,o,i,s,r,l),(m&14)==0&&this.addTriangle_(t,o,e,s,r,a),m&&((m&13)==0&&this.addTriangle_(e,i,t,a,l,s),(m&7)==0&&this.addTriangle_(e,i,o,a,l,r))}calculateSourceExtent(){let t=k1();return this.triangles_.forEach(function(e,o,i){let s=e.source;A2(t,s[0]),A2(t,s[1]),A2(t,s[2])}),t}getTriangles(){return this.triangles_}},lo=C6;var L6=class extends p2{constructor(t,e,o,i,s,a,r,l,c,h,g,d){super(s,y.IDLE,d),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=r,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;let w=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent(),m=this.sourceTileGrid_.getExtent(),p=v?P1(w,v):w;if(B2(p)===0){this.state=y.EMPTY;return}let x=t.getExtent();x&&(m?m=P1(m,x):m=x);let M=i.getResolution(this.wrappedTileCoord_[0]),k=so(t,o,p,M);if(!isFinite(k)||k<=0){this.state=y.EMPTY;return}let z=h!==void 0?h:.5;if(this.triangulation_=new lo(t,o,p,m,k*z,M),this.triangulation_.getTriangles().length===0){this.state=y.EMPTY;return}this.sourceZ_=e.getZForResolution(k);let f=this.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(f[1]=N(f[1],m[1],m[3]),f[3]=N(f[3],m[1],m[3])):f=P1(f,m)),!B2(f))this.state=y.EMPTY;else{let A=0,B=0;t.canWrapX()&&(A=I(x),B=Math.floor((f[0]-x[0])/A)),Ne(f.slice(),t,!0).forEach(S=>{let E=e.getTileRangeForExtentAndZ(S,this.sourceZ_);for(let Z=E.minX;Z<=E.maxX;Z++)for(let $=E.minY;$<=E.maxY;$++){let j=c(this.sourceZ_,Z,$,r);if(j){let c1=B*A;this.sourceTiles_.push({tile:j,offset:c1})}}++B}),this.sourceTiles_.length===0&&(this.state=y.EMPTY)}}getImage(){return this.canvas_}reproject_(){let t=[];if(this.sourceTiles_.forEach(e=>{let o=e.tile;if(o&&o.getState()==y.LOADED){let i=this.sourceTileGrid_.getTileCoordExtent(o.tileCoord);i[0]+=e.offset,i[2]+=e.offset;let s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:i,clipExtent:s,image:o.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=y.ERROR;else{let e=this.wrappedTileCoord_[0],o=this.targetTileGrid_.getTileSize(e),i=typeof o=="number"?o:o[0],s=typeof o=="number"?o:o[1],a=this.targetTileGrid_.getResolution(e),r=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ao(i,s,this.pixelRatio_,r,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=y.LOADED}this.changed()}load(){if(this.state==y.IDLE){this.state=y.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{let o=e.getState();if(o==y.IDLE||o==y.LOADING){t++;let i=R(e,_.CHANGE,s=>{let a=e.getState();(a==y.LOADED||a==y.ERROR||a==y.EMPTY)&&(F(i),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},o,i){e.getState()==y.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(F),this.sourcesListenerKeys_=null}release(){this.canvas_&&(O2(this.canvas_.getContext("2d")),P0.push(this.canvas_),this.canvas_=null),super.release()}},J4=L6;var A6=class{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){let t=this.pop();t instanceof h0&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){let o=this.entries_[t];return T(o!==void 0,"Tried to get a value for a key that does not exist in the cache"),o===this.newest_||(o===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(o.newer.older=o.older,o.older.newer=o.newer),o.newer=null,o.older=this.newest_,this.newest_.newer=o,this.newest_=o),o.value_}remove(t){let e=this.entries_[t];return T(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){let t=new Array(this.count_),e=0,o;for(o=this.newest_;o;o=o.older)t[e++]=o.key_;return t}getValues(){let t=new Array(this.count_),e=0,o;for(o=this.newest_;o;o=o.older)t[e++]=o.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){let t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){T(!(t in this.entries_),"Tried to set a value for a key that is used already");let o={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=o:this.oldest_=o,this.newest_=o,this.entries_[t]=o,++this.count_}setSize(t){this.highWaterMark=t}},co=A6;function m2(n,t,e,o){return o!==void 0?(o[0]=n,o[1]=t,o[2]=e,o):[n,t,e]}function ho(n,t,e){return n+"/"+t+"/"+e}function go(n){return V5(n[0],n[1],n[2])}function V5(n,t,e){return(t<<n)+e}function vo(n,t){let e=n[0],o=n[1],i=n[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;let s=t.getFullTileRange(e);return s?s.containsXY(o,i):!0}var B6=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(i2(),{get:(t,e)=>{if(typeof i2()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,o)=>(this.push_(e,o),!0)})}push_(...t){let e=this.instructions_,o=this.zIndex+this.offset_;e[o]||(e[o]=[]),e[o].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let o=0,i=e.length;o<i;++o){let s=e[o];if(typeof s=="function"){s(t);continue}let a=e[++o];if(typeof t[s]=="function")t[s](...a);else{if(typeof a=="function"){t[s]=a(t);continue}t[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},wo=B6;var H5=5,S6=class extends o4{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=H5}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return O()}getData(t){return null}prepareFrame(t){return O()}renderFrame(t,e){return O()}forEachFeatureAtCoordinate(t,e,o,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){let e=t.target;(e.getState()===V.LOADED||e.getState()===V.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=V.LOADED&&e!=V.ERROR&&t.addEventListener(_.CHANGE,this.boundHandleImageChange_),e==V.IDLE&&(t.load(),e=t.getState()),e==V.LOADED}renderIfReadyAndVisible(){let t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},uo=S6;var x2=null;function O5(){x2=K(1,1,void 0,{willReadFrequently:!0})}var E6=class extends uo{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=e0(),this.pixelTransform=e0(),this.inversePixelTransform=e0(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,o){x2||O5(),x2.clearRect(0,0,1,1);let i;try{x2.drawImage(t,e,o,1,1,0,0,1,1),i=x2.getImageData(0,0,1,1).data}catch{return x2=null,null}return i}getBackground(t){let o=this.getLayer().getBackground();return typeof o=="function"&&(o=o(t.viewState.resolution)),o||void 0}useContainer(t,e,o){let i=this.getLayer().getClassName(),s,a;if(t&&t.className===i&&(!o||t&&t.style.backgroundColor&&g0(E1(t.style.backgroundColor),E1(o)))){let r=t.firstElementChild;r instanceof HTMLCanvasElement&&(a=r.getContext("2d"))}if(a&&f8(a.canvas.style.transform,e)?(this.container=t,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=i;let r=s.style;r.position="absolute",r.width="100%",r.height="100%",a=K();let l=a.canvas;s.appendChild(l),r=l.style,r.position="absolute",r.left="0",r.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&o&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=o)}clipUnrotated(t,e,o){let i=y1(o),s=K0(o),a=X0(o),r=G0(o);s1(e.coordinateToPixelTransform,i),s1(e.coordinateToPixelTransform,s),s1(e.coordinateToPixelTransform,a),s1(e.coordinateToPixelTransform,r);let l=this.inversePixelTransform;s1(l,i),s1(l,s),s1(l,a),s1(l,r),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.clip()}prepareContainer(t,e){let o=t.extent,i=t.viewState.resolution,s=t.viewState.rotation,a=t.pixelRatio,r=Math.round(I(o)/i*a),l=Math.round(J(o)/i*a);n0(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,s,-r/2,-l/2),M4(this.inversePixelTransform,this.pixelTransform);let c=x8(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){let h=this.context.canvas;h.width!=r||h.height!=l?(h.width=r,h.height=l):this.context.clearRect(0,0,r,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(t,e,o){let i=this.getLayer();if(i.hasListener(t)){let s=new K4(t,this.inversePixelTransform,o,e);i.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(u1.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(u1.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new wo),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(u1.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(u1.POSTRENDER,this.context,t))}getRenderTransform(t,e,o,i,s,a,r){let l=s/2,c=a/2,h=i/e,g=-h,d=-t[0]+r,w=-t[1];return n0(this.tempTransform,l,c,h,g,-o,d,w)}disposeInternal(){delete this.frameState,super.disposeInternal()}},po=E6;function V6(n,t,e,o,i){return`${q(n)},${t},${ho(e,o,i)}`}function H6(n,t,e){if(!(e in n))return n[e]=new Set([t]),!0;let o=n[e],i=o.has(t);return i||o.add(t),!i}function R5(n,t,e){let o=n[e];return o?o.delete(t):!1}function mo(n,t){let e=n.layerStatesArray[n.layerIndex];e.extent&&(t=P1(t,t0(e.extent,n.viewState.projection)));let o=e.layer.getRenderSource();if(!o.getWrapX()){let i=o.getTileGridForProjection(n.viewState.projection).getExtent();i&&(t=P1(t,i))}return t}var O6=class extends po{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=k1(),this.tempTileRange_=new $4(0,0,0,0),this.tempTileCoord_=m2(0,0,0);let o=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new co(o),this.maxStaleKeys=o*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,o,i){let s=this.tileCache_,r=this.getLayer().getSource(),l=V6(r,r.getKey(),t,e,o),c;if(s.containsKey(l))c=s.get(l);else{if(c=r.getTile(t,e,o,i.pixelRatio,i.viewState.projection),!c)return null;s.set(l,c)}return c}getTile(t,e,o,i){let s=this.getOrCreateTile(t,e,o,i);return s||null}getData(t){let e=this.frameState;if(!e)return null;let o=this.getLayer(),i=s1(e.pixelToCoordinateTransform,t.slice()),s=o.getExtent();if(s&&!U0(s,i))return null;let a=e.viewState,r=o.getRenderSource(),l=r.getTileGridForProjection(a.projection),c=r.getTilePixelRatio(e.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){let g=l.getTileCoordForCoordAndZ(i,h),d=this.getTile(h,g[1],g[2],e);if(!d||d.getState()!==y.LOADED)continue;let w=l.getOrigin(h),v=G(l.getTileSize(h)),m=l.getResolution(h),p;if(d instanceof W4||d instanceof J4)p=d.getImage();else if(d instanceof z6){if(p=Y4(d.getData()),!p)continue}else continue;let x=Math.floor(c*((i[0]-w[0])/m-g[1]*v[0])),M=Math.floor(c*((w[1]-i[1])/m-g[2]*v[1])),k=Math.round(c*r.getGutterForProjection(a.projection));return this.getImageData(p,x+k,M+k)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;let e=this.getLayer().getSource();if(!e)return!1;let o=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==o&&(this.renderedSourceRevision_=o,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=o,!0}enqueueTiles(t,e,o,i,s){let a=t.viewState,r=this.getLayer(),l=r.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=q(l);h in t.wantedTiles||(t.wantedTiles[h]={});let g=t.wantedTiles[h],d=r.getMapInternal(),w=Math.max(o-s,c.getMinZoom(),c.getZForResolution(Math.min(r.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(r.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),v=a.rotation,m=v?kt(a.center,a.resolution,v,t.size):void 0;for(let p=o;p>=w;--p){let x=c.getTileRangeForExtentAndZ(e,p,this.tempTileRange_),M=c.getResolution(p);for(let k=x.minX;k<=x.maxX;++k)for(let z=x.minY;z<=x.maxY;++z){if(v&&!c.tileCoordIntersectsViewport([p,k,z],m))continue;let f=this.getTile(p,k,z,t);if(!f||!H6(i,f,p))continue;let B=f.getKey();if(g[B]=!0,f.getState()===y.IDLE&&!t.tileQueue.isKeyQueued(B)){let C=m2(p,k,z,this.tempTileCoord_);t.tileQueue.enqueue([f,h,c.getTileCoordCenter(C),M])}}}}findStaleTile_(t,e){let o=this.tileCache_,i=t[0],s=t[1],a=t[2],r=this.getStaleKeys();for(let l=0;l<r.length;++l){let c=V6(this.getLayer().getSource(),r[l],i,s,a);if(o.containsKey(c)){let h=o.peek(c);if(h.getState()===y.LOADED)return h.endTransition(q(this)),H6(e,h,i),!0}}return!1}findAltTiles_(t,e,o,i){let s=t.getTileRangeForTileCoordAndZ(e,o,this.tempTileRange_);if(!s)return!1;let a=!0,r=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let g=s.minY;g<=s.maxY;++g){let d=V6(l,c,o,h,g),w=!1;if(r.containsKey(d)){let v=r.peek(d);v.getState()===y.LOADED&&(H6(i,v,o),w=!0)}w||(a=!1)}return a}renderFrame(t,e){this.renderComplete=!0;let o=t.layerStatesArray[t.layerIndex],i=t.viewState,s=i.projection,a=i.resolution,r=i.center,l=t.pixelRatio,c=this.getLayer(),h=c.getSource(),g=h.getTileGridForProjection(s),d=g.getZForResolution(a,h.zDirection),w=g.getResolution(d),v=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let m=t.extent,p=h.getTilePixelRatio(l);this.prepareContainer(t,e);let x=this.context.canvas.width,M=this.context.canvas.height,k=o.extent&&t0(o.extent,s);k&&(m=P1(m,t0(o.extent,s)));let z=w*x/2/p,f=w*M/2/p,A=[r[0]-z,r[1]-f,r[0]+z,r[1]+f],B={};this.renderedTiles.length=0;let C=c.getPreload();if(t.nextExtent){let Y=g.getZForResolution(i.nextResolution,h.zDirection),W=mo(t,t.nextExtent);this.enqueueTiles(t,W,Y,B,C)}let S=mo(t,m);if(this.enqueueTiles(t,S,d,B,0),C>0&&setTimeout(()=>{this.enqueueTiles(t,S,d-1,B,C-1)},0),!(d in B))return this.container;let E=q(this),Z=t.time;for(let Y of B[d]){let W=Y.getState();if(W===y.EMPTY)continue;let f1=Y.tileCoord;if(W===y.LOADED&&Y.getAlpha(E,Z)===1){Y.endTransition(E);continue}if(W!==y.ERROR&&(this.renderComplete=!1),this.findStaleTile_(f1,B)){R5(B,Y,d),t.animate=!0;continue}if(this.findAltTiles_(g,f1,d+1,B))continue;let O1=g.getMinZoom();for(let U1=d-1;U1>=O1&&!this.findAltTiles_(g,f1,U1,B);--U1);}let $=w/a*l/p,j=this.getRenderContext(t);n0(this.tempTransform,x/2,M/2,$,$,0,-x/2,-M/2),o.extent&&this.clipUnrotated(j,t,k),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,t);let c1=Object.keys(B).map(Number);c1.sort(L0);let n1,q1=[],i0=[];for(let Y=c1.length-1;Y>=0;--Y){let W=c1[Y],f1=h.getTilePixelSize(W,l,s),H1=g.getResolution(W)/w,O1=f1[0]*H1*$,U1=f1[1]*H1*$,R1=g.getTileCoordForCoordAndZ(y1(A),W),s0=g.getTileCoordExtent(R1),d1=s1(this.tempTransform,[p*(s0[0]-A[0])/w,p*(A[3]-s0[3])/w]),C0=p*h.getGutterForProjection(s);for(let a0 of B[W]){if(a0.getState()!==y.LOADED)continue;let T1=a0.tileCoord,X6=R1[1]-T1[1],Ho=Math.round(d1[0]-(X6-1)*O1),K6=R1[2]-T1[2],Oo=Math.round(d1[1]-(K6-1)*U1),r0=Math.round(d1[0]-X6*O1),l0=Math.round(d1[1]-K6*U1),Q2=Ho-r0,t4=Oo-l0,Y6=c1.length===1,ot=!1;n1=[r0,l0,r0+Q2,l0,r0+Q2,l0+t4,r0,l0+t4];for(let e4=0,Ro=q1.length;e4<Ro;++e4)if(!Y6&&W<i0[e4]){let M1=q1[e4];Z1([r0,l0,r0+Q2,l0+t4],[M1[0],M1[3],M1[4],M1[7]])&&(ot||(j.save(),ot=!0),j.beginPath(),j.moveTo(n1[0],n1[1]),j.lineTo(n1[2],n1[3]),j.lineTo(n1[4],n1[5]),j.lineTo(n1[6],n1[7]),j.moveTo(M1[6],M1[7]),j.lineTo(M1[4],M1[5]),j.lineTo(M1[2],M1[3]),j.lineTo(M1[0],M1[1]),j.clip())}q1.push(n1),i0.push(W),this.drawTile(a0,t,r0,l0,Q2,t4,C0,Y6),ot&&j.restore(),this.renderedTiles.unshift(a0),this.updateUsedTiles(t.usedTiles,h,a0)}}if(this.renderedResolution=w,this.extentChanged=!this.renderedExtent_||!L2(this.renderedExtent_,A),this.renderedExtent_=A,this.renderedPixelRatio=l,this.postRender(this.context,t),o.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){let Y=(W,f1)=>{let _0=q(h),H1=f1.wantedTiles[_0],O1=H1?Object.keys(H1).length:0;this.updateCacheSize(O1),this.tileCache_.expireCache()};t.postRenderFunctions.push(Y)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,o,i,s,a,r,l){let c;if(t instanceof z6){if(c=Y4(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;let h=this.getRenderContext(e),g=q(this),d=e.layerStatesArray[e.layerIndex],w=d.opacity*(l?t.getAlpha(g,e.time):1),v=w!==h.globalAlpha;v&&(h.save(),h.globalAlpha=w),h.drawImage(c,r,r,c.width-2*r,c.height-2*r,o,i,s,a),v&&h.restore(),w!==d.opacity?e.animate=!0:l&&t.endTransition(g)}getImage(){let t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,o){let i=q(e);i in t||(t[i]={}),t[i][o.getKey()]=!0}},xo=O6;var J2={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var R6=class extends b0{constructor(t){t=t||{};let e=Object.assign({},t),o=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=o,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(J2.PRELOAD)}setPreload(t){this.set(J2.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(J2.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(J2.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}},fo=R6;var T6=class extends fo{constructor(t){super(t)}createRenderer(){return new xo(this,{cacheSize:this.getCacheSize()})}},b6=T6;var f2=[0,0,0],y0=5,I6=class{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,T(xe(this.resolutions_,(i,s)=>s-i,!0),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!e)e=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,T(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));let o=t.extent;o!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=y1(o)),T(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,T(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:256,T(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=o!==void 0?o:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((i,s)=>{let a=new $4(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(o){let r=this.getTileRangeForExtentAndZ(o,s);a.minX=Math.max(r.minX,a.minX),a.maxX=Math.min(r.maxX,a.maxX),a.minY=Math.max(r.minY,a.minY),a.maxY=Math.min(r.maxY,a.maxY)}return a}):o&&this.calculateTileRanges_(o)}forEachTileCoord(t,e,o){let i=this.getTileRangeForExtentAndZ(t,e);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let r=i.minY,l=i.maxY;r<=l;++r)o([e,s,r])}forEachTileCoordParentTileRange(t,e,o,i){let s,a,r,l=null,c=t[0]-1;for(this.zoomFactor_===2?(a=t[1],r=t[2]):l=this.getTileCoordExtent(t,i);c>=this.minZoom;){if(a!==void 0&&r!==void 0?(a=Math.floor(a/2),r=Math.floor(r/2),s=j0(a,a,r,r,o)):s=this.getTileRangeForExtentAndZ(l,c,o),e(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,o){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){let s=t[1]*2,a=t[2]*2;return j0(s,s+1,a,a+1,e)}let i=this.getTileCoordExtent(t,o||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,o){if(e>this.maxZoom||e<this.minZoom)return null;let i=t[0],s=t[1],a=t[2];if(e===i)return j0(s,a,s,a,o);if(this.zoomFactor_){let l=Math.pow(this.zoomFactor_,e-i),c=Math.floor(s*l),h=Math.floor(a*l);if(e<i)return j0(c,c,h,h,o);let g=Math.floor(l*(s+1))-1,d=Math.floor(l*(a+1))-1;return j0(c,g,h,d,o)}let r=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e,o)}getTileRangeForExtentAndZ(t,e,o){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,f2);let i=f2[1],s=f2[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,f2);let a=f2[1],r=f2[2];return j0(i,a,s,r,o)}getTileCoordCenter(t){let e=this.getOrigin(t[0]),o=this.getResolution(t[0]),i=G(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*o,e[1]-(t[2]+.5)*i[1]*o]}getTileCoordExtent(t,e){let o=this.getOrigin(t[0]),i=this.getResolution(t[0]),s=G(this.getTileSize(t[0]),this.tmpSize_),a=o[0]+t[1]*s[0]*i,r=o[1]-(t[2]+1)*s[1]*i,l=a+s[0]*i,c=r+s[1]*i;return u0(a,r,l,c,e)}getTileCoordForCoordAndResolution(t,e,o){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,o)}getTileCoordForXYAndResolution_(t,e,o,i,s){let a=this.getZForResolution(o),r=o/this.getResolution(a),l=this.getOrigin(a),c=G(this.getTileSize(a),this.tmpSize_),h=r*(t-l[0])/o/c[0],g=r*(l[1]-e)/o/c[1];return i?(h=C2(h,y0)-1,g=C2(g,y0)-1):(h=_2(h,y0),g=_2(g,y0)),m2(a,h,g,s)}getTileCoordForXYAndZ_(t,e,o,i,s){let a=this.getOrigin(o),r=this.getResolution(o),l=G(this.getTileSize(o),this.tmpSize_),c=(t-a[0])/r/l[0],h=(a[1]-e)/r/l[1];return i?(c=C2(c,y0)-1,h=C2(h,y0)-1):(c=_2(c,y0),h=_2(h,y0)),m2(o,c,h,s)}getTileCoordForCoordAndZ(t,e,o){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,o)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){let o=D0(this.resolutions_,t,e||0);return N(o,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Zt(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){let e=this.resolutions_.length,o=new Array(e);for(let i=this.minZoom;i<e;++i)o[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=o}},j6=I6;function Q4(n){let t=n.getDefaultTileGrid();return t||(t=b5(n),n.setDefaultTileGrid(t)),t}function Mo(n,t,e){let o=t[0],i=n.getTileCoordCenter(t),s=tt(e);if(!U0(s,i)){let a=I(s),r=Math.ceil((s[0]-i[0])/a);return i[0]+=a*r,n.getTileCoordForCoordAndZ(i,o)}return t}function T5(n,t,e,o){o=o!==void 0?o:"top-left";let i=ko(n,t,e);return new j6({extent:n,origin:je(n,o),resolutions:i,tileSize:e})}function zo(n){let t=n||{},e=t.extent||i1("EPSG:3857").getExtent(),o={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:ko(e,t.maxZoom,t.tileSize,t.maxResolution)};return new j6(o)}function ko(n,t,e,o){t=t!==void 0?t:42,e=G(e!==void 0?e:256);let i=J(n),s=I(n);o=o>0?o:Math.max(s/e[0],i/e[1]);let a=t+1,r=new Array(a);for(let l=0;l<a;++l)r[l]=o/Math.pow(2,l);return r}function b5(n,t,e,o){let i=tt(n);return T5(i,t,e,o)}function tt(n){n=i1(n);let t=n.getExtent();if(!t){let e=180*$1.degrees/n.getMetersPerUnit();t=u0(-e,-e,e,e)}return t}var I5=/\{z\}/g,j5=/\{x\}/g,P5=/\{y\}/g,D5=/\{-y\}/g;function yo(n,t,e,o,i){return n.replace(I5,t.toString()).replace(j5,e.toString()).replace(P5,o.toString()).replace(D5,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-o).toString()})}function _o(n){let t=[],e=/\{([a-z])-([a-z])\}/.exec(n);if(e){let o=e[1].charCodeAt(0),i=e[2].charCodeAt(0),s;for(s=o;s<=i;++s)t.push(n.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){let o=parseInt(e[2],10);for(let i=parseInt(e[1],10);i<=o;i++)t.push(n.replace(e[0],i.toString()));return t}return t.push(n),t}function F5(n,t){return(function(e,o,i){if(!e)return;let s,a=e[0];if(t){let r=t.getFullTileRange(a);r&&(s=r.getHeight()-1)}return yo(n,a,e[1],e[2],s)})}function Co(n,t){let e=n.length,o=new Array(e);for(let i=0;i<e;++i)o[i]=F5(n[i],t);return N5(o)}function N5(n){return n.length===1?n[0]:(function(t,e,o){if(!t)return;let i=go(t),s=W1(i,n.length);return n[s](t,e,o)})}var P6=class extends Q{constructor(t){super(),this.projection=i1(t.projection),this.attributions_=Lo(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;let e=this;this.viewPromise_=new Promise(function(o,i){e.viewResolver=o,e.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Lo(t),this.changed()}setState(t){this.state_=t,this.changed()}};function Lo(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),t=>n):null}var Ao=P6;var D6=class extends Ao{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;let e=[256,256];this.tileGrid&&G(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||q(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){let e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,o,i,s){return O()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Q4(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,o){let i=this.getTileGridForProjection(o),s=this.getTilePixelRatio(e),a=G(i.getTileSize(t),this.tmpSize);return s==1?a:An(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){let o=e!==void 0?e:this.getProjection(),i=e!==void 0?this.getTileGridForProjection(o):this.tileGrid||this.getTileGridForProjection(o);return this.getWrapX()&&o.isGlobal()&&(t=Mo(i,t,o)),vo(t,i)?t:null}clear(){}refresh(){this.clear(),super.refresh()}},et=class extends a1{constructor(t,e){super(t),this.tile=e}},Bo=D6;var nt={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var F6=class n extends Bo{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===n.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){let e=t.target,o=q(e),i=e.getState(),s;i==y.LOADING?(this.tileLoadingKeys_[o]=!0,s=nt.TILELOADSTART):o in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[o],s=i==y.ERROR?nt.TILELOADERROR:i==y.LOADED?nt.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new et(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){let e=_o(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;let e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Co(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,o){}},So=F6;var N6=class extends So{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:q5,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:W4,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!f4(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){let e=this.getProjection();if(this.tileGrid&&(!e||f4(e,t)))return this.tileGrid;let o=q(t);return o in this.tileGridForProjection||(this.tileGridForProjection[o]=Q4(t)),this.tileGridForProjection[o]}createTile_(t,e,o,i,s,a){let r=[t,e,o],l=this.getTileCoordForTileUrlFunction(r,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(r,c!==void 0?y.IDLE:y.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(_.CHANGE,this.handleTileChange.bind(this)),h}getTile(t,e,o,i,s){let a=this.getProjection();if(!a||!s||f4(a,s))return this.getTileInternal(t,e,o,i,a||s);let r=[t,e,o],l=this.getKey(),c=this.getTileGridForProjection(a),h=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(r,s),d=new J4(a,c,s,h,r,g,this.getTilePixelRatio(i),this.getGutter(),(w,v,m,p)=>this.getTileInternal(w,v,m,p,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(t,e,o,i,s){let a=this.getKey();return this.createTile_(t,e,o,i,s,a)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){let o=i1(t);if(o){let i=q(o);i in this.tileGridForProjection||(this.tileGridForProjection[i]=e)}}};function q5(n,t){n.getImage().src=t}var Eo=N6;var q6=class extends Eo{constructor(t){t=t||{};let e=t.projection!==void 0?t.projection:"EPSG:3857",o=t.tileGrid!==void 0?t.tileGrid:zo({extent:tt(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}},Vo=q6;var U5='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',U6=class extends Vo{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[U5];let o=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",i=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:o,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:i,wrapX:t.wrapX,zDirection:t.zDirection})}},G6=U6;var Rw=(()=>{let t=class t{constructor(){this.data=[],this.datos=Z6(we),st({notifications:ve})}ngOnInit(){return L1(this,null,function*(){yield this.loadMap()})}loadData(){return L1(this,null,function*(){try{let o=yield this.datos.getDatos();this.data=o}catch(o){console.error("Error fetching data:",o)}})}loadMap(){return L1(this,null,function*(){try{let o=yield pe.getCurrentPosition(),i=o.coords.latitude,s=o.coords.longitude;this.map=new x6({target:"mapId",layers:[new b6({source:new G6})],view:new w1({center:It([s,i]),zoom:15})})}catch(o){console.error("Error obteniendo ubicaci\xF3n:",o),this.map=new x6({target:"mapId",layers:[new b6({source:new G6})],view:new w1({center:It([-3.7026,40.4165]),zoom:15})})}})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=$6({type:t,selectors:[["app-inicio"]],decls:22,vars:0,consts:[["contentId","main-content"],[1,"ion-padding"],["id","main-content",1,"ion-page"],[1,"floating-menu"],[1,"menu-btn"],[1,"logo"],["src","assets/img/login.png",1,"img"],[1,"aviso"],[1,"informacion"],["name","notifications"],["color","success",1,"tiempo-llegada"],[1,"content"],["id","mapId",2,"height","100%","width","100%"]],template:function(i,s){i&1&&(c0(0,"ion-menu",0)(1,"ion-header")(2,"ion-toolbar")(3,"ion-title"),z2(4,"Menu Content"),G1()()(),c0(5,"ion-content",1),z2(6,"This is the menu content."),G1()(),c0(7,"div",2)(8,"div",3),M2(9,"ion-menu-button",4),G1(),c0(10,"ion-content")(11,"div",5),M2(12,"ion-img",6),G1(),c0(13,"div",7)(14,"div",8)(15,"ion-text"),z2(16,"Camion Cerca"),G1(),M2(17,"ion-icon",9),G1(),c0(18,"ion-text",10),z2(19,"Llegara en 15 minutos a tu zona"),G1()(),c0(20,"div",11),M2(21,"div",12),G1()()())},dependencies:[se,le,ne,te,ee,ae,re,J6,Q6,ie,oe],styles:["ion-content[_ngcontent-%COMP%]{--background: white;--overflow: hidden}ion-list[_ngcontent-%COMP%]{--background: transparent;background:transparent}ion-item[_ngcontent-%COMP%]{--color: black;--background: transparent;background:transparent}.img[_ngcontent-%COMP%]{display:flex;margin:0 auto;width:220px;height:220px}.floating-menu[_ngcontent-%COMP%]{padding:10px;position:absolute;top:16px;left:16px;z-index:1000}.menu-btn[_ngcontent-%COMP%]{--color: #000000;--background: rgba(255, 255, 255, .8);--border-radius: 50%;width:44px;height:44px}.aviso[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;margin:auto;border-radius:15px;height:8vh;width:70%;color:#000;background-color:#ebf3f3}.tiempo-llegada[_ngcontent-%COMP%]{margin-top:auto;text-align:center;padding-bottom:3%}.informacion[_ngcontent-%COMP%]{font-size:22px;gap:10px;display:flex;align-items:center;justify-content:center}.content[_ngcontent-%COMP%]{overflow:hidden;position:relative;flex-direction:column;margin:0 auto;display:flex;background-color:#ddd6d6;height:50vh;min-height:300px;width:85%;border-radius:20px;top:7%}#mapId[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:20px;position:relative;z-index:1}"]});let n=t;return n})();export{Rw as InicioPage};
